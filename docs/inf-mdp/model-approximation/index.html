<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Aditya Mahajan" />
  <meta name="title" content="ECSE 506: Stochastic Control and Decision Theory" />
  <title>ECSE 506: Stochastic Control and Decision Theory</title>
  
  <meta content="infinite horizon,discounted cost,Lipschitz continuity,approximation bounds,state aggregation" name="keywords" />
  

  <link rel="stylesheet" href="https://adityam.github.io/stochastic-control//css/style.css" type="text/css" /><script type="text/javascript"
    src="https://adityam.github.io/stochastic-control/js/mathjax-local.js" defer>
  </script>
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
  </script>

  <script type="module" defer
    src="//instant.page/3.0.0"
    integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1">
  </script>

  <script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101261731);</script>
  <script async src="//static.getclicky.com/js"></script>

</head>
<body>
<div id="content">
<div class="title">
  <h1>ECSE 506: Stochastic Control and Decision Theory </h1>
  <h2><a href="http://www.cim.mcgill.ca/~adityam/">Aditya Mahajan</a> <br/>
      Winter 2022
  </h2>
  <h3><a href="https://adityam.github.io/stochastic-control/ ">About</a>
	&nbsp;<small><small>|</small></small>&nbsp;
    <a href="https://adityam.github.io/stochastic-control//lectures">Lectures</a></span>
	&nbsp;<small><small>|</small></small>&nbsp;
    <a href="https://adityam.github.io/stochastic-control//notes">Notes</a></span>
	&nbsp;<small><small>|</small></small>&nbsp;
    <a href="https://adityam.github.io/stochastic-control//coursework">Coursework</a>
</h3>
</div>



<div class="h1-title">Theory: Model approximation in MDPs</div>

<p>Consider an MDP <span class="math inline">\(\ALPHABET M = \langle \ALPHABET S, \ALPHABET A, P, c, γ \rangle\)</span>. Suppose the components <span class="math inline">\(\langle \ALPHABET S, \ALPHABET A, γ \rangle\)</span> but we know <span class="math inline">\((c,P)\)</span> only approximately. Consider the approximate MDP <span class="math inline">\(\widehat {\ALPHABET M} = \langle \ALPHABET S, \ALPHABET A, \hat P, \hat c, γ \rangle\)</span>. Suppose <span class="math inline">\(\hat π^*\)</span> is an optimal policy policy for <span class="math inline">\(\widehat {\ALPHABET M}\)</span>. We are interested in the following question:</p>
<blockquote>
<p><em>What is the approximation error in using the policy <span class="math inline">\(\hat π^*\)</span> (which is optimal in the approximate model) in the true model.</em></p>
</blockquote>
<h1 data-number="1" id="preliminary-results"><span class="header-section-number">1</span> Preliminary results</h1>
<p>Define the following <em>Bellman error</em> operator: <span class="math inline">\(Δ{\ALPHABET B}\)</span> from <span class="math inline">\(\reals^n\)</span> to <span class="math inline">\(\reals^n\)</span>, where <span class="math inline">\(n = |\ALPHABET S|\)</span>. For any <span class="math inline">\(v \in \reals^n\)</span> <span class="math display">\[\begin{align*}
  [Δ{\ALPHABET B} v]_s  = \max_{a \in \ALPHABET A} \Biggl| &amp;
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) v(s&#39;) 
  \notag \\
  &amp; \quad - 
  \hat c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) v(s&#39;) 
  \Biggr| 
\end{align*}\]</span></p>
<p>We first start with a useful Lemma.</p>
<div class="highlight">
<dl>
<dt><span id="lem:1"></span><span id="lem:bound-policy" class="pandoc-numbering-text lem"><strong>Lemma 1</strong></span></dt>
<dd>
<p>For any (possibly randomized) policy <span class="math inline">\(π\)</span>, <span class="math display">\[\begin{equation}\label{eq:bound-0}
   \| V^{π} - \hat V^{π} \|_∞ \le 
   \frac{γ}{1-γ} \min\{ Δ \ALPHABET B V^{π}, Δ \ALPHABET B \hat V^{π} \}. 
\end{equation}\]</span></p>
</dd>
</dl>
</div>
<details>
<!--{{{ Proof -->
<summary>
<h4 class="unnumbered" id="proof">Proof</h4>
</summary>
<div>
<p>We bound the left hand side of \eqref{eq:bound-0} in two ways. The first way is as follows: <span class="math display">\[\begin{align}
  \| V^{π} - \hat V^{π} \|_∞ 
  &amp;\le
  \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) V^{π}(s&#39;) \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) \hat V^{π}(s&#39;) \Biggr| 
  \notag \\
  &amp;\stackrel{(a)}\le
  \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) V^{π}(s&#39;) \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) {\color{red} V^{π}(s&#39;)} \Biggr| 
  \notag \\
  &amp; \quad + γ \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} π(a|s) 
  \Biggl| \sum_{s&#39; \in \ALPHABET S} 
  \biggl[ \hat P(s&#39;|s,a) V^{π}(s&#39;) - \hat P(s&#39;|s,a) \hat V^{π}(s)\biggr] \Biggr| 
  \notag \\
  &amp;\stackrel{(b)}\le γ Δ \ALPHABET B V^{π} + γ \| V^{π} - \hat V^{π} \|_∞
  \label{eq:ineq-3}
\end{align}\]</span> where <span class="math inline">\((a)\)</span> follows from triangle inequality and <span class="math inline">\((b)\)</span> follows from the definition of <span class="math inline">\(Δ \ALPHABET B\)</span>. Rearranging terms in \eqref{eq:ineq-3} gives us $$<span class="math display">\[\begin{equation}
\| V^{π} - \hat V^{π} \|_∞ \le \frac{γ Δ \ALPHABET B V^{\hat
π}}{1 - γ}.
\label{eq:ineq-4}\end{equation}\]</span> This gives the first bound.</p>
<p>Now, another way to bound the left hand side of \eqref{eq:bound-0} is as follows: <span class="math display">\[\begin{align}
  \| V^{π} - \hat V^{π} \|_∞ 
  &amp;\le
  \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) V^{π}(s&#39;) \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) \hat V^{π}(s&#39;) \Biggr| 
  \notag \\
  &amp;\stackrel{(c)}\le
  \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) {\color{red} \hat V^{π}(s&#39;)} \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \sum_{a \in \ALPHABET A} π(a | s) \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) \hat V^{π}(s&#39;) \Biggr| 
  \notag \\
  &amp; \quad + γ \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} π(a|s) 
  \Biggl| \sum_{s&#39; \in \ALPHABET S} 
  \biggl[ P(s&#39;|s,a) V^{π}(s&#39;) - P(s&#39;|s,a) \hat V^{π}(s)\biggr] \Biggr| 
  \notag \\
  &amp;\stackrel{(d)}\le γ Δ \ALPHABET B \hat V^{π} + γ \| V^{π} - \hat V^{π} \|_∞
  \label{eq:ineq-13}
\end{align}\]</span> where <span class="math inline">\((c)\)</span> follows from triangle inequality and <span class="math inline">\((d)\)</span> follows from the definition of <span class="math inline">\(Δ \ALPHABET B\)</span>. Rearranging terms in \eqref{eq:ineq-13} gives us <span class="math display">\[\begin{equation}
\| V^{π} - \hat V^{π} \|_∞ \le \frac{γ Δ \ALPHABET B
\hat V^{π}}{1 - γ}.
\label{eq:ineq-14}\end{equation}\]</span> This gives the second bound.</p>
</div>
</details>
<!--}}}-->
<p>Similar to the above, we can also bound the difference between the optimal value function of the original and approximate models.</p>
<div class="highlight">
<dl>
<dt><span id="lem:2"></span><span id="lem:bound-opt" class="pandoc-numbering-text lem"><strong>Lemma 2</strong></span></dt>
<dd>
<p>Let <span class="math inline">\(V^*\)</span> and <span class="math inline">\(\hat V^*\)</span> denote the optimal value functions for <span class="math inline">\(\ALPHABET M\)</span> and <span class="math inline">\(\widehat {\ALPHABET M}\)</span>, respectively. Then, <span class="math display">\[\begin{equation}\label{eq:bound-1}
    \| V^* - \hat V^* \|_∞ \le 
    \frac{γ}{1-γ} \min\{ Δ \ALPHABET B V^*, Δ \ALPHABET  B \hat V^* \} 
\end{equation}\]</span></p>
</dd>
</dl>
</div>
<details>
<summary>
<h4 class="unnumbered" id="proof-1">Proof</h4>
</summary>
<div>
<p>We bound the left hand side of \eqref{eq:bound-1} in two ways. The first was is as follows: <span class="math display">\[\begin{align}
  \| V^* - \hat V^{*} \|_∞ 
  &amp;\stackrel{(a)}\le
  \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) V^*(s&#39;) \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) \hat V^*(s&#39;) \Biggr| 
  \notag \\
  &amp;\stackrel{(b)}\le
  \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) V^*(s&#39;) \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) {\color{red} V^*(s&#39;)} \Biggr| 
  \notag \\
  &amp; \quad + γ \max_{s \in \ALPHABET S, a \in \ALPHABET A}
  \Biggl| \sum_{s&#39; \in \ALPHABET S} 
  \biggl[ \hat P(s&#39;|s,a) V^*(s&#39;) - \hat P(s&#39;|s,a) \hat V^*(s&#39;)\biggr] \Biggr| 
  \notag \\
  &amp;\stackrel{(c)}\le γ Δ \ALPHABET B V^* + γ \| V^* - \hat V^* \|_∞
  \label{eq:ineq-1}
\end{align}\]</span> where <span class="math inline">\((a)\)</span> follows from the fact that <span class="math inline">\(| \min f(x) - \min g(x) | \le \max | f(x) - g(x) |\)</span>, <span class="math inline">\((b)\)</span> follows from triangle inequality, and <span class="math inline">\((c)\)</span> follows from the definition of <span class="math inline">\(Δ \ALPHABET B\)</span>. Rearranging terms in \eqref{eq:ineq-1}, gives us <span class="math display">\[\begin{equation}
\| V^* - \hat V^* \|_∞ \le \frac{ γ Δ \ALPHABET B V^*}{1 - γ}.
\label{eq:ineq-2}\end{equation}\]</span> This gives the first bound.</p>
<p>Now, another way to bound the left hand side of \eqref{eq:bound-1} is as follows: <span class="math display">\[\begin{align}
  \| V^* - \hat V^{*} \|_∞ 
  &amp;\stackrel{(d)}\le
  \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) V^*(s&#39;) \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) \hat V^*(s&#39;) \Biggr| 
  \notag \\
  &amp;\stackrel{(e)}\le
  \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) \color{red}{\hat
  V^*(s&#39;)} \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) \hat V^*(s&#39;) \Biggr| 
  \notag \\
  &amp; \quad + γ \max_{s \in \ALPHABET S, a \in \ALPHABET A}
  \Biggl| \sum_{s&#39; \in \ALPHABET S} 
  \biggl[ P(s&#39;|s,a) V^*(s&#39;) - P(s&#39;|s,a) \hat V^*(s&#39;)\biggr] \Biggr| 
  \notag \\
  &amp;\stackrel{(f)}\le γ Δ \ALPHABET B  \hat V^* + γ \| V^* - \hat V^* \|_∞
  \label{eq:ineq-11}
\end{align}\]</span> where <span class="math inline">\((d)\)</span> follows from the fact that <span class="math inline">\(| \min f(x) - \min g(x) | \le \max | f(x) - g(x) |\)</span>, <span class="math inline">\((e)\)</span> follows from triangle inequality, and <span class="math inline">\((f)\)</span> follows from the definition of <span class="math inline">\(Δ \ALPHABET B\)</span>. Rearranging terms in \eqref{eq:ineq-11}, gives us <span class="math display">\[\begin{equation}
\| V^* - \hat V^* \|_∞ \le \frac{ γ Δ \ALPHABET B \hat V^*}{1 - γ}.
\label{eq:ineq-12}\end{equation}\]</span> This is the second value of <span class="math inline">\(Δ_1\)</span>.</p>
</div>
</details>
<!--}}}-->
<details>
<!--{{{ Proof -->
<summary>
<h4 class="unnumbered" id="a-partial-alternative-proof">A partial alternative proof</h4>
</summary>
<div>
<p>It is tempting to try to prove <a href="#lem:bound-opt" title="Lemma 2"><span class="pandoc-numbering-link lem">Lemma 2</span></a> using <a href="#lem:bound-policy" title="Lemma 1"><span class="pandoc-numbering-link lem">Lemma 1</span></a>, but that approach does not work. We present it here for completeness.</p>
<p>Since <span class="math inline">\(π^*\)</span> is optimal for <span class="math inline">\(\ALPHABET M\)</span>, we have <span class="math inline">\(V^* \le V^{\hat π^*}\)</span>. Therefore, <span class="math display">\[ V^* - \hat V^* \le V^{\hat π^*} - \hat V^{\hat π^*} 
  \le \frac{γ}{1-γ} \min\{ Δ \ALPHABET B V^{\hat π^*}, Δ \ALPHABET B \hat V^* \}\]</span></p>
<p>where the last inequality follows from <a href="#lem:bound-policy" title="Lemma 1"><span class="pandoc-numbering-link lem">Lemma 1</span></a>.</p>
<p>By a similar argument, we have <span class="math inline">\(\hat V^* \le \hat V^{π^*}\)</span>. Threfore, <span class="math display">\[
  \hat V^* - V^* \le \hat V^{π^*} - V^{π^*} \le
  \frac{γ}{1-γ} \min\{ Δ \ALPHABET B V^*, Δ \ALPHABET B \hat V^{π^*} \}.
\]</span></p>
</div>
</details>
<!--}}}-->
<h1 data-number="2" id="model-approximation-bounds"><span class="header-section-number">2</span> Model approximation bounds</h1>
<div class="highlight">
<dl>
<dt><span id="thm:1"></span><span id="thm:ais-bound" class="pandoc-numbering-text thm"><strong>Theorem 1</strong></span></dt>
<dd>
<p>The policy <span class="math inline">\(\hat π^*\)</span> is an <span class="math inline">\(α\)</span>-optimal policy of <span class="math inline">\(\ALPHABET M\)</span> where <span class="math display">\[\begin{equation} \label{eq:bound}
α := \| V^* - V^{\hat π^*} \|_∞ \le
\frac{γ}{1 - γ}\bigl[ Δ_1 + Δ_2 \bigr]
%(Δ \ALPHABET B V^* + Δ \ALPHABET B V^{\hat π^*})}
\end{equation}\]</span> where <span class="math display">\[
 Δ_1 \le \min\{ Δ \ALPHABET B V^*, Δ \ALPHABET B \hat V^* \}
 \quad\text{and}\quad
 Δ_2 \le \min\{ Δ \ALPHABET B V^{\hat π^*}, Δ \ALPHABET B \hat V^{\hat π^*} \}.
\]</span></p>
</dd>
</dl>
</div>
<details>
<summary>
<h4 class="unnumbered" id="proof-2">Proof</h4>
</summary>
<div>
<p>From triangle inequality we have <span class="math display">\[\begin{equation} \label{eq:triangle-1}
  \| V^* - V^{\hat π^*} \|_∞ \le
  \| V^* - \hat V^{\hat π^*} \|_∞ 
  + 
  \| V^{\hat π^*} - \hat V^{\hat π^*} \|_∞.
\end{equation}\]</span> The result then follows by bounding the first term using <a href="#lem:bound-opt" title="Lemma 2"><span class="pandoc-numbering-link lem">Lemma 2</span></a> and the second term using <a href="#lem:bound-policy" title="Lemma 1"><span class="pandoc-numbering-link lem">Lemma 1</span></a>.</p>
</div>
</details>
<p>Note that depending on how we pick <span class="math inline">\(Δ_1\)</span> and <span class="math inline">\(Δ_2\)</span>, we get four possible upper bounds and can bound <span class="math inline">\(α\)</span> by the tightest of them, i.e., <span class="math display">\[\begin{equation}\label{eq:combined}
  α \le \frac{γ}{1 - γ} \min\bigl\{
  Δ \ALPHABET B V^* + Δ \ALPHABET B V^{\hat π^*}, \space 
  Δ \ALPHABET B V^* + Δ \ALPHABET B \hat V^*, \space
  Δ \ALPHABET B \hat V^* + Δ \ALPHABET B V^{\hat π^*}, \space 
  2Δ \ALPHABET B \hat V^* \bigr\}
\end{equation}\]</span> where we have used the fact that <span class="math inline">\(\hat V^{\hat π^*} = \hat V^*\)</span> to simplify some of the terms.</p>
<p>Ideally, we want an upper bound that just depends on the original model or just on the approximate model. The last bound in \eqref{eq:combined} depends just on the approximate model. We state it separately for ease of reference.</p>
<div class="highlight">
<dl>
<dt><span id="cor:1"></span><span id="cor:ais-bound" class="pandoc-numbering-text cor"><strong>Corollary 1</strong></span></dt>
<dd>
<p>The policy <span class="math inline">\(\hat π^*\)</span> is an <span class="math inline">\(α\)</span>-optimal policy of <span class="math inline">\(\ALPHABET M\)</span> where <span class="math display">\[\begin{equation}
    α := \| V^* - V^{\hat π^*} \|_∞ \le
    \frac{2γ}{1-γ} \ALPHABET B \hat V^*. 
\end{equation}\]</span></p>
</dd>
</dl>
</div>
<p>In the next lemma, we develop a bound that depends just on the original model.</p>
<div class="highlight">
<dl>
<dt><span id="thm:2"></span><span id="thm:ais-bound2" class="pandoc-numbering-text thm"><strong>Theorem 2</strong></span></dt>
<dd>
<p>The policy <span class="math inline">\(\hat π^*\)</span> is an <span class="math inline">\(α\)</span>-optimal policy of <span class="math inline">\(\ALPHABET M\)</span> where <span class="math display">\[\begin{equation}
    α := \| V^* - V^{\hat π^*} \|_∞ \le
    \frac{2γ}{(1-γ)^2} \ALPHABET B V^*. 
\end{equation}\]</span></p>
</dd>
</dl>
</div>
<details>
<summary>
<h4 class="unnumbered" id="proof-3">Proof</h4>
</summary>
<div>
<p>As before, we consider the following bound by triangle inequality. <span class="math display">\[\begin{equation} \label{eq:triangle-2}
  \| V^* - V^{\hat π^*} \|_∞ \le
  \| V^* - \hat V^{\hat π^*} \|_∞ 
  + 
  \| V^{\hat π^*} - \hat V^{\hat π^*} \|_∞.
\end{equation}\]</span> We will bound the first term of \eqref{eq:triangle-2} by <a href="#lem:bound-opt" title="Lemma 2"><span class="pandoc-numbering-link lem">Lemma 2</span></a>. But instead of bounding the second term of \eqref{eq:triangle-2} by <a href="#lem:bound-policy" title="Lemma 1"><span class="pandoc-numbering-link lem">Lemma 1</span></a>, we consider the following: <span class="math display">\[\begin{align}
  \| V^{\hat π^*} - \hat V^{\hat π^*} \|_∞ 
  &amp;\le
  \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} \hat π^*(a | s) \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) V^{\hat π^*}(s&#39;) \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \sum_{a \in \ALPHABET A} \hat π^*(a | s) \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) \hat V^{\hat π^*}(s&#39;) \Biggr| 
  \notag \\
  &amp;\stackrel{(a)}\le
  \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} \hat π^*(a | s) \Biggl|
  c(s,a) + γ \sum_{s&#39; \in \ALPHABET S} P(s&#39;|s,a) {\color{red} V^{*}(s&#39;)} \notag \\
  &amp; 
  \hphantom{= \max_{s \in \ALPHABET S, a \in \ALPHABET A} \sum_{a \in \ALPHABET A} \hat π^*(a | s) \Biggl|}
  - 
  \hat c(s,a) - γ \sum_{s&#39; \in \ALPHABET S} \hat P(s&#39;|s,a) {\color{red} V^{*}(s&#39;)} \Biggr| 
  \notag \\
  &amp; \quad + γ \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} \hat π^*(a|s) 
  \Biggl| \sum_{s&#39; \in \ALPHABET S} 
  \biggl[ P(s&#39;|s,a) V^{\hat π*}(s&#39;) - P(s&#39;|s,a) V^{*}(s&#39;)\biggr] \Biggr| 
  \notag \\
  &amp; \quad + γ \max_{s \in \ALPHABET S} \sum_{a \in \ALPHABET A} \hat π^*(a|s) 
  \Biggl| \sum_{s&#39; \in \ALPHABET S} 
  \biggl[ \hat P(s&#39;|s,a) V^{*}(s&#39;) - \hat P(s&#39;|s,a) \hat V^{\hat π^*}(s&#39;)\biggr] \Biggr| 
  \notag \\
  &amp;\stackrel{(b)}\le γ Δ \ALPHABET B V^{*} + γ \| V^{*} - V^{\hat π^*} \|_∞
  + γ \| V^{*} - \hat V^{*} \|_∞
  \label{eq:ineq-21}.
\end{align}\]</span> where <span class="math inline">\((a)\)</span> follows from triangle inequality and <span class="math inline">\((b)\)</span> follows from the definition of <span class="math inline">\(Δ \ALPHABET B\)</span> and (for the last term of <span class="math inline">\((b)\)</span>) that <span class="math inline">\(\hat V^{\hat π^*} = \hat V^*\)</span>.</p>
<p>Substituting \eqref{eq:ineq-21} in \eqref{eq:triangle-2} and rearranging terms, we get <span class="math display">\[\begin{align}
  \| V^* - V^{\hat π^*} \|_∞ 
  &amp;\le
  \frac{γ}{1-γ} Δ \ALPHABET  B V^*
  + 
  \frac{1+γ}{1-γ} \| V^* - \hat V^* \|_∞
  \notag \\
  &amp;\le
  \frac{γ}{1-γ} Δ \ALPHABET  B V^*
  + 
  \frac{γ(1+γ)}{(1-γ)^2} Δ \ALPHABET B V^* 
  \notag \\
  &amp;= \frac{2γ}{(1-γ)^2} Δ \ALPHABET B V^*. 
\end{align}\]</span> where the second inequality follows from <a href="#lem:bound-opt" title="Lemma 2"><span class="pandoc-numbering-link lem">Lemma 2</span></a>.</p>
</div>
</details>
<!--}}}-->
<dl>
<dt><span id="rem:1"></span><span id="rem:comparison" class="pandoc-numbering-text rem"><strong>Remark 1</strong></span></dt>
<dd>
<p>Note that the bound of <a href="#cor:ais-bound" title="Corollary 1"><span class="pandoc-numbering-link cor">Corollary 1</span></a> is tighter by a factor of <span class="math inline">\(1/(1-γ)\)</span>, but this bound is in terms of <span class="math inline">\(\hat V^*\)</span>. In some settings, we prefer a bound in terms of <span class="math inline">\(V^*\)</span>. Using <a href="#thm:ais-bound2" title="Theorem 2"><span class="pandoc-numbering-link thm">Theorem 2</span></a> in such settings leads to scaling by <span class="math inline">\(1/(1-γ)\)</span>.</p>
</dd>
</dl>


<p class="categories">
This entry 

 was last updated on 12 Nov 2022
 and posted in 

<a href="https://adityam.github.io/stochastic-control/categories/mdp">
  MDP</a>
and tagged
<a href="https://adityam.github.io/stochastic-control/tags/infinite-horizon">infinite horizon</a>,
<a href="https://adityam.github.io/stochastic-control/tags/discounted-cost">discounted cost</a>,
<a href="https://adityam.github.io/stochastic-control/tags/lipschitz-continuity">lipschitz continuity</a>,
<a href="https://adityam.github.io/stochastic-control/tags/approximation-bounds">approximation bounds</a>,
<a href="https://adityam.github.io/stochastic-control/tags/state-aggregation">state aggregation</a>.</p>



    </div>
  </body>
</html>


