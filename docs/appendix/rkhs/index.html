<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Aditya Mahajan" />
  <meta name="title" content="ECSE 506: Stochastic Control and Decision Theory" />
  <title>ECSE 506: Stochastic Control and Decision Theory</title>
  
  <meta content="Vector space,Hilbert space,Banach space" name="keywords" />
  

  <link rel="stylesheet" href="https://adityam.github.io/stochastic-control//css/style.css" type="text/css" /><script type="text/javascript"
    src="https://adityam.github.io/stochastic-control/js/mathjax-local.js" defer>
  </script>
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
  </script>

  <script type="module" defer
    src="//instant.page/3.0.0"
    integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1">
  </script>

  <script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101261731);</script>
  <script async src="//static.getclicky.com/js"></script>

</head>
<body>
<div id="content">
<div class="title">
  <h1>ECSE 506: Stochastic Control and Decision Theory </h1>
  <h2><a href="http://www.cim.mcgill.ca/~adityam/">Aditya Mahajan</a> <br/>
      Winter 2020
  </h2>
  <h3><a href="https://adityam.github.io/stochastic-control/ ">About</a>
	&nbsp;<small><small>|</small></small>&nbsp;
    <a href="https://adityam.github.io/stochastic-control//lectures">Lectures</a></span>
	&nbsp;<small><small>|</small></small>&nbsp;
    <a href="https://adityam.github.io/stochastic-control//notes">Notes</a></span>
	&nbsp;<small><small>|</small></small>&nbsp;
    <a href="https://adityam.github.io/stochastic-control//coursework">Coursework</a>
</h3>
</div>



<div class="h1-title">Reproducing Kernel Hilbert Space</div>

<h1 data-number="1" id="linear-operators"><span class="header-section-number">1</span> Linear Operators</h1>
<div class="highlight">
<dl>
<dt><span id="definition:operator" class="pandoc-numbering-text definition"><strong>Definition 1</strong></span></dt>
<dd><p><strong>(Linear operator)</strong> Let <span class="math inline">\(\mathcal F\)</span> and <span class="math inline">\(\mathcal G\)</span> be normed vector spaces over <span class="math inline">\(\reals\)</span>. A function <span class="math inline">\(A \colon \mathcal F \to \mathcal G\)</span> is called a <strong>linear operator</strong> if it satisfies the following properties:</p>
<ul>
<li><em>Honogeneity:</em> For any <span class="math inline">\(α \in \reals\)</span> and <span class="math inline">\(f \in \mathcal F\)</span>, <span class="math inline">\(A(αf) = α (Af)\)</span>.</li>
<li><em>Additivity:</em> For any <span class="math inline">\(f,g \in \mathcal F\)</span>, <span class="math inline">\(A(f + g) = Af + Ag\)</span>.</li>
</ul>
<p>The <strong>operator norm</strong> of a linear operator is defined as <span class="math display">\[ \NORM{A} = \sup_{f \in \mathcal F} \frac{ \NORM{A f}_{\mathcal G}}
  {\NORM{f}}_{\mathcal F}. \]</span></p>
<p>If <span class="math inline">\(\NORM{A} &lt; ∞\)</span>, then the operator is said to be a bounded operator.</p>
</dd>
</dl>
</div>
<p>As an example, suppose <span class="math inline">\(\mathcal F\)</span> is an inner product space. For a <span class="math inline">\(g \in \mathcal F\)</span>, the operator <span class="math inline">\(A_g \colon \mathcal F \to \reals\)</span> defined by <span class="math inline">\(A_g(f) = \langle f, g \rangle\)</span> is a linear operator. Such scalar valued operators are called <em>functionals</em> on <span class="math inline">\(\mathcal F\)</span>.</p>
<p>Linear operators satisfy the following property.</p>
<div class="highlight">
<dl>
<dt><span id="theorem:operator" class="pandoc-numbering-text theorem"><strong>Theorem 1</strong></span></dt>
<dd><p>If <span class="math inline">\(A \colon \mathcal F \to \mathcal G\)</span> is a linear operator, then the following three conditions are equivalent:</p>
<ol type="1">
<li><span class="math inline">\(A\)</span> is a bounded operator.</li>
<li><span class="math inline">\(A\)</span> is continuous on <span class="math inline">\(\mathcal F\)</span>.</li>
<li><span class="math inline">\(A\)</span> is continious at one point of <span class="math inline">\(\mathcal F\)</span>.</li>
</ol>
</dd>
</dl>
</div>
<p>There are two notions of <em>dual</em> of a linear operator: <em>algebraic dual</em> and <em>topological dual</em>. If <span class="math inline">\(\mathcal F\)</span> is a normed space, then the space of all <em>linear</em> functionals <span class="math inline">\(A \colon \mathcal F \to \reals\)</span> is the <em>algebraic dual</em> space of <span class="math inline">\(\mathcal F\)</span>; the space of all <em>continuous linear</em> functions <span class="math inline">\(A \colon \mathcal F \to \reals\)</span> is the <em>topological dual</em> space of <span class="math inline">\(\mathcal F\)</span>.</p>
<p>In finite-dimensional space, the two notions of dual spaces coincide (every linear operator on a normed, finite dimensional space is bounded). But this is not the case for infinite dimensional spaces.</p>
<div class="highlight">
<dl>
<dt><span id="theorem:riesz" class="pandoc-numbering-text theorem"><strong>Theorem 2</strong></span></dt>
<dd><p><strong>(Riesz representation)</strong> In a Hilbert space <span class="math inline">\(\mathcal F\)</span>, all continuous linear functionals are of the form <span class="math inline">\(\langle\cdot, g\rangle\)</span>, for some <span class="math inline">\(g \in \mathcal F\)</span>.</p>
</dd>
</dl>
</div>
<p>Two Hilbert spaces <span class="math inline">\(\mathcal F\)</span> and <span class="math inline">\(\mathcal G\)</span> are said to be <strong>isometrically isomorphic</strong> if there is a linear bijective map <span class="math inline">\(U \colon \mathcal F \to \mathcal G\)</span> which preserves the inner product, i.e., <span class="math inline">\(\langle f_1, f_2 \rangle_{\mathcal F} = \langle U f_1, U f_2 \rangle_{\mathcal G}\)</span>.</p>
<p>Note that Riesz representation theorem gives a natural isometric isomorphism <span class="math inline">\(\psi \colon g \mapsto \langle \cdot, g \rangle_{\mathcal F}\)</span> between <span class="math inline">\(\mathcal F\)</span> and its topological dual <span class="math inline">\(\mathcal F&#39;\)</span>, whereby <span class="math inline">\(\NORM{ψ(g)}_{\mathcal F&#39;} = \NORM{g}_{\mathcal F}\)</span>.</p>
<h1 data-number="2" id="reproducing-kernel-hilbert-space"><span class="header-section-number">2</span> Reproducing kernel Hilbert space</h1>
<p>Let <span class="math inline">\(\mathcal H\)</span> be a Hilbert space of functions mapping from some non-empty set <span class="math inline">\(\ALPHABET X\)</span> to <span class="math inline">\(\reals\)</span>. Note that for every <span class="math inline">\(x \in \ALPHABET X\)</span>, there is a very special functional on <span class="math inline">\(\mathcal H\)</span>: the one that assigns to each <span class="math inline">\(f \in \mathcal H\)</span>, its value at <span class="math inline">\(x\)</span>. This is called the <strong>evaluation functional</strong> and denoted by <span class="math inline">\(δ_x\)</span>. In particular, <span class="math inline">\(δ_x \colon \mathcal H \to \reals\)</span>, where <span class="math inline">\(δ_x \colon f \mapsto f(x)\)</span>.</p>
<div class="highlight">
<dl>
<dt><span id="definition:RKHS" class="pandoc-numbering-text definition"><strong>Definition 2</strong></span></dt>
<dd><p><strong>(Reproducing kernel Hilbert space).</strong> A Hilbert space <span class="math inline">\(\mathcal H\)</span> of functions <span class="math inline">\(f \colon \ALPHABET X \to \reals\)</span> defined on a non-empty set <span class="math inline">\(\ALPHABET X\)</span> is said to be a RKHS if <span class="math inline">\(δ_x\)</span> is continuous for all <span class="math inline">\(x \in  \ALPHABET X\)</span>.</p>
</dd>
</dl>
</div>
<p>In view of <a href="#theorem:operator" title="Theorem 1"><span class="pandoc-numbering-link theorem">Theorem 1</span></a>, an equivalent definition is that a Hilbert space <span class="math inline">\(\mathcal H\)</span> is RKHS if the evaluation functionals <span class="math inline">\(δ_x\)</span> are bounded, i.e., for every <span class="math inline">\(x \in \ALPHABET X\)</span>, there exists a <span class="math inline">\(M_x\)</span> such that <span class="math display">\[ | δ_x | = | f(x) | \le M_x \| f \|_{\mathcal H}, \quad \forall f \in \mathcal H\]</span></p>
<p>An immediate implication of the above property is that two functions which agree in RKHS norm agree at every point: <span class="math display">\[ | f(x) - g(x) | = | δ_x(f - g) | \le M_x \| f - g \|_{\mathcal H},
   \quad \forall f,g \in \mathcal H. \]</span></p>
<p>For example, the <span class="math inline">\(L_2\)</span> space of square integrable functions i.e., <span class="math inline">\(\int_{\reals^n} f(x)^2 dx &lt; ∞\)</span> with inner product <span class="math inline">\(\int_{\reals^n} f(x) g(x)dx\)</span> is a Hilbert space, but not an RKHS because the delta function, which has the reproducing property <span class="math display">\[ f(x) = \int_{\reals^n} δ(x - y) f(y) dy \]</span> is not bounded.</p>
<p>RKHS are particularly well behaved. In particular, if we have a sequence of functions <span class="math inline">\(\{f_n\}_{n \ge 1}\)</span> which converges to a limit <span class="math inline">\(f\)</span> in the Hilbert-space norm, i.e., <span class="math inline">\(\lim_{n \to ∞} \NORM{f_n - f}_{\mathcal H} = 0\)</span>, then they also converge pointwise, i.e., <span class="math inline">\(\lim_{n \to ∞} f_n(x) = f(x)\)</span> for all <span class="math inline">\(x \in \ALPHABET X\)</span>.</p>
<h2 data-number="2.1" id="properties-of-rhks"><span class="header-section-number">2.1</span> Properties of RHKS</h2>
<p>RKHS has many useful properties:</p>
<ol type="1">
<li><p>For any RKHS, there exists a <em>unique</em> kernel <span class="math inline">\(k \colon \ALPHABET X × \ALPHABET X \to \reals\)</span> such that</p>
<ul>
<li>for any <span class="math inline">\(x \in \ALPHABET X\)</span>, <span class="math inline">\(k(\cdot, x) \in \mathcal H\)</span>,</li>
<li>for any <span class="math inline">\(x \in \ALPHABET X\)</span> and <span class="math inline">\(f \in \mathcal H\)</span>, <span class="math inline">\(\langle f, k(\cdot, x) \rangle = f(x)\)</span> (the reproducing property).</li>
</ul>
<p>In particular, for any <span class="math inline">\(x,y \in \ALPHABET X\)</span>, <span class="math display">\[ k(x,y) = \langle k(\cdot, x), k(\cdot, y) \rangle. \]</span> Thus, the kernel is a symmetric function.</p></li>
<li><p>The kernel is positive definite, i.e., for any <span class="math inline">\(n \ge 1\)</span>, for all <span class="math inline">\((a_1, \dots, a_n) \in \reals^n\)</span> and <span class="math inline">\((x_1, \dots, x_n) \in \ALPHABET X^n\)</span>, <span class="math display">\[ \sum_{i=1}^n \sum_{j=1}^n a_i a_i h(x_i, x_j) \ge 0 \]</span></p>
<p>A conseuqence of positive definiteness is that <span class="math display">\[| k(x, y)|^2 \le k(x, x) k(y, y). \]</span></p></li>
<li><p><strong>(Moore-Aronszajn Theorem)</strong> For every positive definite kernel <span class="math inline">\(K\)</span> on <span class="math inline">\(\ALPHABET X × \ALPHABET X\)</span>, there is a unique RKHS on <span class="math inline">\(\ALPHABET X\)</span> with <span class="math inline">\(K\)</span> as its reproducing kernel.</p></li>
</ol>
<h2 data-number="2.2" id="examples-of-kernels"><span class="header-section-number">2.2</span> Examples of kernels</h2>
<p>Some common examples of symmetric positive definite kernels for <span class="math inline">\(\ALPHABET X = \reals^n\)</span> are as follows:</p>
<ol type="1">
<li><p><strong>Linear kernel</strong> <span class="math display">\[ k(x,y) = \langle x, y \rangle\]</span></p></li>
<li><p><strong>Gaussian kernel</strong> <span class="math display">\[ k(x,y) = \exp\biggl( - \frac{\| x - y \|^2}{σ^2} \biggr), 
   \quad σ &gt; 0. \]</span></p></li>
<li><p><strong>Polynomail kernel</strong> <span class="math display">\[ k(x,y) = \bigl( 1 + \langle x, y \rangle \bigr)^d, 
   \quad d \in \integers_{&gt; 0}. \]</span></p></li>
</ol>
<h2 data-number="2.3" id="properties-of-kernels"><span class="header-section-number">2.3</span> Properties of kernels</h2>
<ol type="1">
<li><p>Suppose <span class="math inline">\(φ \colon \ALPHABET X \to \reals^n\)</span> is a feature map, then <span class="math display">\[ k(x,y) := \langle φ(x), φ(y) \rangle \]</span> is a kernel.</p>
<p>Note that there are no conditions on <span class="math inline">\(\ALPHABET X\)</span> (e.g., <span class="math inline">\(\ALPHABET X\)</span> doesn’t need to be an inner product space).</p></li>
<li><p>If <span class="math inline">\(k\)</span> is a kernel on <span class="math inline">\(\ALPHABET X\)</span>, then for any <span class="math inline">\(α &gt; 0\)</span>, <span class="math inline">\(αk\)</span> is also a kernel.</p></li>
<li><p>If <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span> are kernels on <span class="math inline">\(\ALPHABET X\)</span>, then <span class="math inline">\(k_1 + k_2\)</span> is also a kernel.</p></li>
<li><p>If <span class="math inline">\(\ALPHABET X\)</span> and <span class="math inline">\(\ALPHABET Y\)</span> be arbitrary sets and <span class="math inline">\(A \colon \ALPHABET X \to \ALPHABET Y\)</span> is a map. Let <span class="math inline">\(k\)</span> be a kernel on <span class="math inline">\(\ALPHABET Y\)</span>. Then, <span class="math inline">\(k(A(x_1), A(x_2))\)</span> is a kernel on <span class="math inline">\(\ALPHABET X\)</span>.</p></li>
<li><p>If <span class="math inline">\(k_1 \colon \ALPHABET X_1 × \ALPHABET X_1 \to \reals\)</span> is a kernel on <span class="math inline">\(\ALPHABET X_1\)</span> and <span class="math inline">\(k_2 \colon \ALPHABET X_2 × \ALPHABET X_2 \to \reals\)</span> is a kernel on <span class="math inline">\(\ALPHABET X_2\)</span>, then <span class="math display">\[ k( (x_1, x_2), (y_1, y_2) ) = k_1(x_1, y_1) k_2(x_2, y_2) \]</span> is a kernel on <span class="math inline">\(\ALPHABET X_1 × \ALPHABET X_2\)</span>.</p></li>
<li><p><strong>(Mercer-Hilber-Schmit theorems)</strong> If <span class="math inline">\(k\)</span> is positive definite kernel (that is continous with finite trace), then there exists an infinite sequence of eiegenfunctions <span class="math inline">\(\{ φ_i \colon \ALPHABET X \to \reals \}_{i \ge 1}\)</span> and real eigenvalues <span class="math inline">\(\{λ_i\}_{i \ge 1}\)</span> such that we can write <span class="math inline">\(k\)</span> as: <span class="math display">\[ k(x,y) = \sum_{i=1}^∞ λ_i φ_i(x) φ_i(y). \]</span> This is analogous to the expression of a matrix in terms of its eigenvector and eigenvalues, except in this case we have functions and an infinity of them.</p>
<p>Using this property, we can define the inner product of RKHS in a simpler form. First, for any <span class="math inline">\(f \in \mathcal H\)</span>, define <span class="math display">\[ f_i = \langle f, φ_i \rangle.\]</span> Then, for any <span class="math inline">\(f, g \in \mathcal H\)</span>, <span class="math display">\[ \langle f, g \rangle = \sum_{i=1}^∞ \frac{ f_i g_i } { λ_i }. \]</span></p></li>
</ol>
<h1 data-number="3" id="kernel-ridge-regression"><span class="header-section-number">3</span> Kernel ridge regression</h1>
<p>Given labelled data <span class="math inline">\(\{ (x_i, y_i) \}_{i=1}^n\)</span>, and a feature map <span class="math inline">\(φ \colon \ALPHABET X \to \ALPHABET Z\)</span>, define the RKHS <span class="math inline">\(\ALPHABET H\)</span> of functions from <span class="math inline">\(\ALPHABET Z \to \reals\)</span> with the kernel <span class="math inline">\(k(x,y) = \langle φ(x), φ(y) \rangle_{\mathcal H}\)</span>. Now, consider the problem of minimizing</p>
<p><span class="math display">\[f^* = \arg \min_{f \in \ALPHABET H}
\biggl( 
  \sum_{i=1}^n \bigl( y_i - \langle f, φ(x_i) \rangle_{\mathcal{H}} \bigr)^2 + 
  λ \NORM{f}^2_{\mathcal H}
\bigr).\]</span></p>
<p><strong>The representer theoreom</strong> (simple version). Given a loss function <span class="math inline">\(\ell \colon \ALPHABET Z^n \to \reals\)</span> and a penalty function <span class="math inline">\(Ω \colon \reals \to \reals\)</span>, there is as a solution of <span class="math display">\[ f^* = \arg \min_{f \in \mathcal H} \ell(f(x_1), \dots, f(x_n)) 
        + Ω(\NORM{f}^2_{\mathcal H}). \]</span> that takes the the form <span class="math display">\[ f^* = \sum_{i=1}^n α_i k(\cdot, x_i).\]</span> If <span class="math inline">\(Ω\)</span> is strictly increasing, all solutions have this form.</p>
<p>Using the representer theorem, we know that the solution is of the form <span class="math display">\[ f = \sum_{i=1}^n α_i φ(x_i). \]</span> Then, <span class="math display">\[
\sum_{i=1}^n \bigl( y_i - \langle f, φ_i(x_i) \rangle_{\mathcal H} \bigr)^2
  + λ \NORM{f}_{\mathcal H}^2 
= \NORM{ y - K α}^2 + λ α^\TRANS K α. \]</span></p>
<p>Differentiating wrt <span class="math inline">\(α\)</span> and setting this to zero, we get <span class="math display">\[ 
  α^* = (K + λI_n)^{-1} y. 
\]</span></p>


<p class="categories">
This entry 
</p>



    </div>
  </body>
</html>


