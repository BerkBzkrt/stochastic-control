---
title: Integral Probablity Metrics
keywords:
  - IPM
---

[TODO: Add introduction]

## Definition of Integral Probability Metrics

### Notation {-}



1. Let $(\ALPHABET X,d)$ be a complete separable metric space, i.e., a Polish space.

2. Let $w \colon \ALPHABET X \to [1,∞)$  be a measurable function and define the weighted norm of any function $f \colon \ALPHABET X \to \reals$ as
   $$ \NORM{f}_w = \sup_{x \in \ALPHABET X} \frac{f(x)}{w(x)}. $$

3. Let $\ALPHABET M(\ALPHABET X)$ denote the set of all measurable real-valued functions on $\ALPHABET X$ and let $\ALPHABET M_w(\ALPHABET X)$ denote the subset with bounded $w$-norm, i.e., 
   $$ \ALPHABET M_w(\ALPHABET X) = 
   \{ f \in \ALPHABET M(\ALPHABET X) : \NORM{f}_w < ∞ \} $$

4. Let $\mathfrak X$ denote the Borel $σ$-algebra of $\ALPHABET X$. 

5. Let $\ALPHABET P(\ALPHABET X)$ denote the set of all probaility measures on $(\ALPHABET X, \mathfrak X)$ and $\ALPHABET P_w(\ALPHABET X) = \{ μ \in \ALPHABET P(\ALPHABET X) : \int w dμ < ∞ \}$. 

$\def\F{\mathfrak F}$
Integral probability metrics (IPMs) are pseudo-metrics on $\ALPHABET P_w(\ALPHABET X)$ defined as follows.

:::{#def-IPM}
  The integral probability metric $d_{\mathfrak F}$ is a pseudo-metric on $\ALPHABET P_w(\ALPHABET X)$ generated by the function class $\F \subset \ALPHABET M_w(\ALPHABET X)$ is defined as 
  $$
    d_{\F}(μ_1, μ_2) =
    \sup_{f \in \F}
    \biggl|
    \int f d μ_1 - \int f d μ_2
    \biggr|,
    \quad
    \forall μ_1, μ_2 \in \ALPHABET P_w(\ALPHABET X).
  $$
  The function $f$ is called _the witness function_ and the function class $\F$ is called _the generator_.
:::

An IPM is a pseudo-metric, i.e., it satisfies the following properties:
for all $μ_1, μ_2, μ_3 \in \ALPHABET P_w(\ALPHABET X)$

1. $d_{\F}(μ_1, μ_2) = 0$ 
2. **Symmetry.** $d_{\F}(μ_1, μ_2) = d_{\F}(μ_2, μ_1)$ 
3. **Triangle inequality.** 
   $d_{\F}(μ_1, μ_3) \le d_{\F}(μ_1, μ_2) + d_{\F}(μ_2, μ_3)$.

IPM is a metric when $d(μ_1, μ_2) = 0 \implies μ_1 = μ_2$. 

### Examples {-}

[TODO]

### Maximal generators {-}

So far, we haven't imposed any restriction on the generator $\F$. We now present a canonical representation of a generator.

:::{#def-maximal-generator}
 For a function class $\F \in \ALPHABET M_w(\ALPHABET X)$, define the **maximal generator** $\ALPHABET G_{\F}$ as
 $$
    \ALPHABET G_{\F} = 
    \biggl\{
      f \in \ALPHABET M_w(\ALPHABET X) : 
      \biggl| \int f d μ_1 - \int f d μ_2 \biggr| \le d_{\F}(μ_1, μ_2), \space
      \text{for all } μ_1, μ_2 \in \ALPHABET P_w(\ALPHABET X)
      \biggr\}.
  $$
:::

Maximal generators have the following properties.

:::{#prp-maximal-generators}
  Let $\F \subset \ALPHABET M_w(\ALPHABET X)$ be an arbitary generator. Then:
  
  1. $\ALPHABET G_{\F}$ contains the convex hull of $\F$. 
  2. If $f \in \ALPHABET G_{\F}$, then $α f + β \in \ALPHABET G_{\F}$ for all $|α| < 1$ and $β \in \reals$. 
  3. If the sequence $\{f_n\}_{n \ge 1} \in \ALPHABET G_{\F}$ converges uniformly to $f$, then $f \in \ALPHABET G_{\F}$. 
:::

Maximal generators also allow us to compare IPMs with different generators. 

:::{.callout-tip}
### Balanced set
A set $\ALPHABET S$ is said to be balanced if for all scalars $a$ satisfying $|a| < 1$, we have $a \ALPHABET S \subset \ALPHABET S$.
:::

:::{#prp-maximal-generators-comparison}
  Let $\F \subset \mathfrak D \subset \ALPHABET M_w(\ALPHABET X)$ and $μ_1, μ_2 \in \ALPHABET P_w(\ALPHABET X)$. Then

  1. $d_{\F}(μ_1, μ_2) \le d_{\mathfrak D}(μ_1, μ_2)$.
  2. $\ALPHABET G_{\F} \subset \ALPHABET G_{\mathfrak D}$. 
  3. If $\mathfrak D \subset \ALPHABET G_{\F}$ then $d_{\F}$ and $d_{\mathfrak D}$ are identical.
  4. If $\F \subset \mathfrak D \subset \ALPHABET G_{\F}$ and $\mathfrak D$ is convex and balanced, contains the constant functions, and is closed with respect to pointwise convergence, then $\mathfrak D = \ALPHABET G_{\F}$.
:::

## Properties of IPMs

We will assume that the generator $\F$ is the maximal generator. In particular, this means that $0 \in \F$ is an interior point. We will also implicitly assume that $\ALPHABET M_w(\ALPHABET X) \subset (0,∞)\F \coloneqq \cup_{0 < r < ∞} r\F$, i.e., $\F$ is an absorbing set.

For any function $f \in \ALPHABET M_w(\ALPHABET X)$ define the **Minkowski functional (or gauge)** as follows:
$$
  ρ_{\F}(f) = \inf \big\{ ρ > 0 : f/ρ \in \F \bigr\}.
$$
where the infimum of an empty set is defined as infinity. 

:::{#prp-IPM-ineq}
  For any $f \in \ALPHABET M_w(\ALPHABET X)$ and any $μ_1, μ_2 \in \ALPHABET P_w(\ALPHABET X)$, we have
  $$
  \left|
  \int f d μ_1 - \int f d μ_2 
  \right|
  \le
  ρ_{\F}(f) d_{\F}(μ_1, μ_2).
  $$
:::

[TODO: Explain the Minkowski functional for the examples]

In all the above examples, the Minkowski functional is a semi-norm, which is a general property.

:::{#prp-Minkowski-seminorm}
The Minkowski functional is a semi-norm, i.e., it satisfies the following properties:

1. **Non-negativity.** $ρ(f) \ge 0$. 
2. **Absolute homogeneity** $ρ_{\F}(a f) = |a| ρ_{\F}(f)$ for all scalars $a$.
3. **Subadditivity.** $ρ_{\F}(f_1 + f_2) \le ρ_{\F}(f_1) + ρ_{\F}(f_2)$.
:::

:::{.callout-note collapse="true"}
### Proof
Non-negativity holds by definition. Absolute homogeneity holds because $\F$ is balanced, in particular $\F = -\F$. Note that absolute homogeneity implies $ρ_{\F}(0) = 0$.

To see why subadditivity holds, let $ρ_1 = ρ_{\F}(f_1)$ and $ρ_2 = ρ_{\F}(f_2)$. Then, since $\F$ is convex, we have for any $λ \in [0,1]$, 
$$
  λ \frac{f_1}{ρ_1} + (1-λ) \frac{f_2}{ρ_2} \in \F.
$$
Take $λ = ρ_1/(ρ_1 + ρ_2)$, which implies $(f_1 + f_2)/(ρ_1 + ρ_2) \in \F$. Thus, $ρ_{\F}(f_1 + f_2) \le ρ_1 + ρ_2$.
:::


## Notes {-}

IPMs were first defined by @Zolotarev1984, where they were called probability metrics with $ζ$-structure. The term IPM was coined by @Muller1997a. The discussion here is mostly borrowed from @Muller1997a.
