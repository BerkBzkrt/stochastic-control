{
  "hash": "843e4fe4ba410c86fa1b7cf81397505c",
  "result": {
    "markdown": "---\ntitle: \"Stochastic approximation\"\nkeywords:\n  - reinforcement learning\n  - stochastic approximation\nexecute:\n  echo: false\n  freeze: auto\n---\n\nSuppose $f \\colon \\reals^d \\to \\reals^d$ and it is desired to find a solution $θ^*$ to the equation $f(θ) = 0$. There are many methods for determining the value of\n$θ$ by successive approximation where we start with an initial guess $θ_0$ and\nthen recursively obtain a new value $θ_{t+1}$ as a function of the previously\nobtained $θ_0, \\dots, θ_{k}$, the values $f(θ_1), \\dots, f(θ_{t})$, and\npossibly those of the derivatives $f'(θ_0), \\dots, f'(θ_{t})$, etc. If \n$$\n  \\lim_{t \\to ∞} θ_t = θ^*,\n$$\nirrespective of the initial condition $θ_0$, then the successive approximation\nmethod is effective. \n\nIn many applications, the function $f$ may be unknown so it is not possible to\nobtain the value $f(θ)$, but it may be possible to conduct an experiment to\nget the value of $f(θ)$ with noise. Stochastic approximation refers to\nrecursive algorithms of the form\n$$ \\begin{equation} \\label{eq:SA}\n  θ_{t+1} = θ_t + a_t[ f(θ_t) + ξ_{t+1} ], \\quad t \\ge 0\n\\end{equation} $$\nwhere $\\{a_t\\}_{t \\ge 0}$ is a sequence of positive numbers and \n$\\{ξ_t\\}_{t \\ge 0}$ is a noise sequence.\n\nWe are interested in the limit behavior of the sequence $\\{θ_t\\}_{t \\ge 0}$. \n\n::: {#exm-urn-model}\nConsider an initially empty urn to which black or red balls are added one at a time. Let $r_t$ denote the number of red balls at time $t$ and $θ_t = r_t/t$ denote the _fraction_ of red balls at time $t$. Suppose that \n$$\n  \\PR(\\text{next ball is red} \\mid \\text{all past}) = p(\\text{fraction of red balls})\n$$\nwhere $p \\colon [0,1] \\to [0,1]$ is prespecified. \n\nIn this model, the sequence $\\{r_t\\}_{t \\ge 1}$ follows the recursion:\n$$\n  r_{t+1} = r_t + w_{t+1}\n$$\nwhere $w_{t+1} = \\IND\\{(t+1)\\text{-st ball is red}\\}$. Therefore,\n$$\n  θ_{t+1} = θ_t + \\frac{1}{t+1}( w_{t+1} - θ_t )\n$$\nwith $θ_0 = 0$. We can rewrite the above equation as\n$$\n  θ_{t+1} = θ_t + \\frac{1}{t+1}\\bigl[ (p(θ_t) - θ_t ) + (w_{t+1} - p(θ_t)) \\bigr]\n$$\nDefine $ξ_{t+1} = w_{t+1} - p(θ_t)$. Note that $\\{ξ_t\\}_{t \\ge 1}$ is Martingale difference sequence, i.e., $\\EXP[ ξ_{t+1} \\mid θ_0, w_{1:t} ] = 0$. Thus the above equation is of the form \\\\eqref{eq:SA} with $f(θ_t) = p(θ_t) - θ_t$. \n:::\n\nThe key idea behind stochastic approximation is that under appropriate\nconditions, the iteration \\\\eqref{eq:SA} almost surely converges to the\nequilibrium point of the ODE\n$$ \\begin{equation} \\label{eq:ODE}\n  \\dot θ(t) = f(θ(t))\n\\end{equation} $$\nwith initial conditions $θ(0) = θ_0$. For instance, for @exm-urn-model, this means that under appropriate conditions, the discrete-time iterates $\\{θ_t\\}_{t \\ge 0}$ converge to the solution of the ODE \\\\eqref{eq:ODE}. In particular, they would converge to the equilibrium set $H = \\{ θ : p(θ) = θ \\}$. \n\n\n\n::: {.cell execution_count=2}\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\np (generic function with 1 method)\n```\n:::\n:::\n\n\n::: {.cell .column-margin execution_count=3}\n\n::: {#fig-p-vs-theta .cell-output .cell-output-display execution_count=4}\n```{=html}\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"300\" height=\"200\" viewBox=\"0 0 1200 800\">\n<defs>\n  <clipPath id=\"clip430\">\n    <rect x=\"0\" y=\"0\" width=\"1200\" height=\"800\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip430)\" d=\"M0 800 L1200 800 L1200 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip431\">\n    <rect x=\"240\" y=\"0\" width=\"841\" height=\"800\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip430)\" d=\"M174.274 631.18 L1152.76 631.18 L1152.76 47.2441 L174.274 47.2441  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip432\">\n    <rect x=\"174\" y=\"47\" width=\"979\" height=\"585\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"201.967,631.18 201.967,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"432.741,631.18 432.741,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"663.515,631.18 663.515,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"894.289,631.18 894.289,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1125.06,631.18 1125.06,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"248.122,631.18 248.122,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"294.276,631.18 294.276,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"340.431,631.18 340.431,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"386.586,631.18 386.586,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"478.896,631.18 478.896,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"525.051,631.18 525.051,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"571.205,631.18 571.205,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"617.36,631.18 617.36,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"709.67,631.18 709.67,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"755.825,631.18 755.825,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"801.979,631.18 801.979,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"848.134,631.18 848.134,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"940.444,631.18 940.444,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"986.599,631.18 986.599,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"1032.75,631.18 1032.75,47.2441 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"1078.91,631.18 1078.91,47.2441 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"201.967,631.18 201.967,612.282 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"432.741,631.18 432.741,612.282 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"663.515,631.18 663.515,612.282 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"894.289,631.18 894.289,612.282 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"1125.06,631.18 1125.06,612.282 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"248.122,631.18 248.122,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"294.276,631.18 294.276,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"340.431,631.18 340.431,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"386.586,631.18 386.586,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"478.896,631.18 478.896,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"525.051,631.18 525.051,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"571.205,631.18 571.205,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"617.36,631.18 617.36,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"709.67,631.18 709.67,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"755.825,631.18 755.825,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"801.979,631.18 801.979,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"848.134,631.18 848.134,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"940.444,631.18 940.444,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"986.599,631.18 986.599,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"1032.75,631.18 1032.75,621.731 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"1078.91,631.18 1078.91,621.731 \"/>\n<path clip-path=\"url(#clip430)\" d=\"M164.27 652.499 Q160.659 652.499 158.831 656.063 Q157.025 659.605 157.025 666.735 Q157.025 673.841 158.831 677.406 Q160.659 680.947 164.27 680.947 Q167.905 680.947 169.71 677.406 Q171.539 673.841 171.539 666.735 Q171.539 659.605 169.71 656.063 Q167.905 652.499 164.27 652.499 M164.27 648.795 Q170.08 648.795 173.136 653.401 Q176.215 657.985 176.215 666.735 Q176.215 675.461 173.136 680.068 Q170.08 684.651 164.27 684.651 Q158.46 684.651 155.381 680.068 Q152.326 675.461 152.326 666.735 Q152.326 657.985 155.381 653.401 Q158.46 648.795 164.27 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M184.432 678.1 L189.316 678.1 L189.316 683.98 L184.432 683.98 L184.432 678.1 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M209.502 652.499 Q205.89 652.499 204.062 656.063 Q202.256 659.605 202.256 666.735 Q202.256 673.841 204.062 677.406 Q205.89 680.947 209.502 680.947 Q213.136 680.947 214.941 677.406 Q216.77 673.841 216.77 666.735 Q216.77 659.605 214.941 656.063 Q213.136 652.499 209.502 652.499 M209.502 648.795 Q215.312 648.795 218.367 653.401 Q221.446 657.985 221.446 666.735 Q221.446 675.461 218.367 680.068 Q215.312 684.651 209.502 684.651 Q203.691 684.651 200.613 680.068 Q197.557 675.461 197.557 666.735 Q197.557 657.985 200.613 653.401 Q203.691 648.795 209.502 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M239.663 652.499 Q236.052 652.499 234.224 656.063 Q232.418 659.605 232.418 666.735 Q232.418 673.841 234.224 677.406 Q236.052 680.947 239.663 680.947 Q243.298 680.947 245.103 677.406 Q246.932 673.841 246.932 666.735 Q246.932 659.605 245.103 656.063 Q243.298 652.499 239.663 652.499 M239.663 648.795 Q245.474 648.795 248.529 653.401 Q251.608 657.985 251.608 666.735 Q251.608 675.461 248.529 680.068 Q245.474 684.651 239.663 684.651 Q233.853 684.651 230.775 680.068 Q227.719 675.461 227.719 666.735 Q227.719 657.985 230.775 653.401 Q233.853 648.795 239.663 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M395.542 652.499 Q391.931 652.499 390.102 656.063 Q388.297 659.605 388.297 666.735 Q388.297 673.841 390.102 677.406 Q391.931 680.947 395.542 680.947 Q399.176 680.947 400.982 677.406 Q402.811 673.841 402.811 666.735 Q402.811 659.605 400.982 656.063 Q399.176 652.499 395.542 652.499 M395.542 648.795 Q401.352 648.795 404.408 653.401 Q407.486 657.985 407.486 666.735 Q407.486 675.461 404.408 680.068 Q401.352 684.651 395.542 684.651 Q389.732 684.651 386.653 680.068 Q383.598 675.461 383.598 666.735 Q383.598 657.985 386.653 653.401 Q389.732 648.795 395.542 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M415.704 678.1 L420.588 678.1 L420.588 683.98 L415.704 683.98 L415.704 678.1 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M434.801 680.045 L451.12 680.045 L451.12 683.98 L429.176 683.98 L429.176 680.045 Q431.838 677.29 436.421 672.66 Q441.028 668.008 442.208 666.665 Q444.454 664.142 445.333 662.406 Q446.236 660.647 446.236 658.957 Q446.236 656.202 444.292 654.466 Q442.37 652.73 439.269 652.73 Q437.07 652.73 434.616 653.494 Q432.185 654.258 429.408 655.809 L429.408 651.087 Q432.232 649.952 434.685 649.374 Q437.139 648.795 439.176 648.795 Q444.546 648.795 447.741 651.48 Q450.935 654.165 450.935 658.656 Q450.935 660.786 450.125 662.707 Q449.338 664.605 447.232 667.198 Q446.653 667.869 443.551 671.086 Q440.449 674.281 434.801 680.045 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M460.982 649.42 L479.338 649.42 L479.338 653.355 L465.264 653.355 L465.264 661.827 Q466.282 661.48 467.301 661.318 Q468.319 661.133 469.338 661.133 Q475.125 661.133 478.505 664.304 Q481.884 667.475 481.884 672.892 Q481.884 678.471 478.412 681.572 Q474.94 684.651 468.62 684.651 Q466.444 684.651 464.176 684.281 Q461.931 683.91 459.523 683.17 L459.523 678.471 Q461.607 679.605 463.829 680.16 Q466.051 680.716 468.528 680.716 Q472.532 680.716 474.87 678.61 Q477.208 676.503 477.208 672.892 Q477.208 669.281 474.87 667.174 Q472.532 665.068 468.528 665.068 Q466.653 665.068 464.778 665.485 Q462.926 665.901 460.982 666.781 L460.982 649.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M625.818 652.499 Q622.207 652.499 620.379 656.063 Q618.573 659.605 618.573 666.735 Q618.573 673.841 620.379 677.406 Q622.207 680.947 625.818 680.947 Q629.453 680.947 631.258 677.406 Q633.087 673.841 633.087 666.735 Q633.087 659.605 631.258 656.063 Q629.453 652.499 625.818 652.499 M625.818 648.795 Q631.629 648.795 634.684 653.401 Q637.763 657.985 637.763 666.735 Q637.763 675.461 634.684 680.068 Q631.629 684.651 625.818 684.651 Q620.008 684.651 616.93 680.068 Q613.874 675.461 613.874 666.735 Q613.874 657.985 616.93 653.401 Q620.008 648.795 625.818 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M645.98 678.1 L650.865 678.1 L650.865 683.98 L645.98 683.98 L645.98 678.1 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M661.096 649.42 L679.452 649.42 L679.452 653.355 L665.378 653.355 L665.378 661.827 Q666.397 661.48 667.415 661.318 Q668.434 661.133 669.452 661.133 Q675.239 661.133 678.619 664.304 Q681.999 667.475 681.999 672.892 Q681.999 678.471 678.526 681.572 Q675.054 684.651 668.735 684.651 Q666.559 684.651 664.29 684.281 Q662.045 683.91 659.638 683.17 L659.638 678.471 Q661.721 679.605 663.943 680.16 Q666.165 680.716 668.642 680.716 Q672.647 680.716 674.985 678.61 Q677.323 676.503 677.323 672.892 Q677.323 669.281 674.985 667.174 Q672.647 665.068 668.642 665.068 Q666.767 665.068 664.892 665.485 Q663.04 665.901 661.096 666.781 L661.096 649.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M701.212 652.499 Q697.6 652.499 695.772 656.063 Q693.966 659.605 693.966 666.735 Q693.966 673.841 695.772 677.406 Q697.6 680.947 701.212 680.947 Q704.846 680.947 706.651 677.406 Q708.48 673.841 708.48 666.735 Q708.48 659.605 706.651 656.063 Q704.846 652.499 701.212 652.499 M701.212 648.795 Q707.022 648.795 710.077 653.401 Q713.156 657.985 713.156 666.735 Q713.156 675.461 710.077 680.068 Q707.022 684.651 701.212 684.651 Q695.401 684.651 692.323 680.068 Q689.267 675.461 689.267 666.735 Q689.267 657.985 692.323 653.401 Q695.401 648.795 701.212 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M857.09 652.499 Q853.479 652.499 851.65 656.063 Q849.845 659.605 849.845 666.735 Q849.845 673.841 851.65 677.406 Q853.479 680.947 857.09 680.947 Q860.724 680.947 862.53 677.406 Q864.359 673.841 864.359 666.735 Q864.359 659.605 862.53 656.063 Q860.724 652.499 857.09 652.499 M857.09 648.795 Q862.9 648.795 865.956 653.401 Q869.034 657.985 869.034 666.735 Q869.034 675.461 865.956 680.068 Q862.9 684.651 857.09 684.651 Q851.28 684.651 848.201 680.068 Q845.146 675.461 845.146 666.735 Q845.146 657.985 848.201 653.401 Q851.28 648.795 857.09 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M877.252 678.1 L882.136 678.1 L882.136 683.98 L877.252 683.98 L877.252 678.1 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M891.141 649.42 L913.363 649.42 L913.363 651.411 L900.817 683.98 L895.932 683.98 L907.738 653.355 L891.141 653.355 L891.141 649.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M922.53 649.42 L940.886 649.42 L940.886 653.355 L926.812 653.355 L926.812 661.827 Q927.83 661.48 928.849 661.318 Q929.868 661.133 930.886 661.133 Q936.673 661.133 940.053 664.304 Q943.432 667.475 943.432 672.892 Q943.432 678.471 939.96 681.572 Q936.488 684.651 930.168 684.651 Q927.993 684.651 925.724 684.281 Q923.479 683.91 921.071 683.17 L921.071 678.471 Q923.155 679.605 925.377 680.16 Q927.599 680.716 930.076 680.716 Q934.08 680.716 936.418 678.61 Q938.756 676.503 938.756 672.892 Q938.756 669.281 936.418 667.174 Q934.08 665.068 930.076 665.068 Q928.201 665.068 926.326 665.485 Q924.474 665.901 922.53 666.781 L922.53 649.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M1077.14 680.045 L1084.77 680.045 L1084.77 653.679 L1076.46 655.346 L1076.46 651.087 L1084.73 649.42 L1089.4 649.42 L1089.4 680.045 L1097.04 680.045 L1097.04 683.98 L1077.14 683.98 L1077.14 680.045 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M1106.49 678.1 L1111.37 678.1 L1111.37 683.98 L1106.49 683.98 L1106.49 678.1 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M1131.56 652.499 Q1127.94 652.499 1126.12 656.063 Q1124.31 659.605 1124.31 666.735 Q1124.31 673.841 1126.12 677.406 Q1127.94 680.947 1131.56 680.947 Q1135.19 680.947 1137 677.406 Q1138.82 673.841 1138.82 666.735 Q1138.82 659.605 1137 656.063 Q1135.19 652.499 1131.56 652.499 M1131.56 648.795 Q1137.37 648.795 1140.42 653.401 Q1143.5 657.985 1143.5 666.735 Q1143.5 675.461 1140.42 680.068 Q1137.37 684.651 1131.56 684.651 Q1125.75 684.651 1122.67 680.068 Q1119.61 675.461 1119.61 666.735 Q1119.61 657.985 1122.67 653.401 Q1125.75 648.795 1131.56 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M1161.72 652.499 Q1158.11 652.499 1156.28 656.063 Q1154.47 659.605 1154.47 666.735 Q1154.47 673.841 1156.28 677.406 Q1158.11 680.947 1161.72 680.947 Q1165.35 680.947 1167.16 677.406 Q1168.99 673.841 1168.99 666.735 Q1168.99 659.605 1167.16 656.063 Q1165.35 652.499 1161.72 652.499 M1161.72 648.795 Q1167.53 648.795 1170.58 653.401 Q1173.66 657.985 1173.66 666.735 Q1173.66 675.461 1170.58 680.068 Q1167.53 684.651 1161.72 684.651 Q1155.91 684.651 1152.83 680.068 Q1149.77 675.461 1149.77 666.735 Q1149.77 657.985 1152.83 653.401 Q1155.91 648.795 1161.72 648.795 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M675.45 719.217 Q675.45 724.628 673.711 730.715 Q672.004 736.769 669.299 741.665 Q666.593 746.528 663.051 749.748 Q659.508 752.937 656.126 752.937 Q653.969 752.937 652.358 751.745 Q650.78 750.521 649.911 748.492 Q649.041 746.431 648.622 744.177 Q648.204 741.89 648.204 739.41 Q648.204 735.707 649.009 731.681 Q649.814 727.623 651.167 723.951 Q652.519 720.248 654.419 716.898 Q656.32 713.517 658.413 711.069 Q660.539 708.589 662.922 707.14 Q665.305 705.691 667.527 705.691 Q669.137 705.691 670.426 706.399 Q671.746 707.075 672.584 708.267 Q673.421 709.427 674.001 710.811 Q674.612 712.196 674.902 713.807 Q675.192 715.385 675.321 716.705 Q675.45 717.993 675.45 719.217 M671.102 715.127 Q671.102 713.484 670.973 712.261 Q670.844 711.005 670.49 709.749 Q670.136 708.493 669.363 707.816 Q668.622 707.14 667.463 707.14 Q664.081 707.14 660.281 714.064 Q659.057 716.222 657.962 719.153 Q656.867 722.083 656.481 723.468 Q656.094 724.853 655.192 728.267 L668.976 728.267 Q671.102 719.475 671.102 715.127 M668.397 730.36 L654.677 730.36 Q652.551 738.412 652.551 743.436 Q652.551 747.816 653.453 749.652 Q654.387 751.455 656.126 751.455 Q658.123 751.455 659.991 749.458 Q661.859 747.429 663.759 743.758 Q666.271 738.992 668.397 730.36 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"174.274,614.653 1152.76,614.653 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"174.274,476.933 1152.76,476.933 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"174.274,339.212 1152.76,339.212 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"174.274,201.491 1152.76,201.491 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"174.274,63.7706 1152.76,63.7706 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,587.109 1152.76,587.109 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,559.565 1152.76,559.565 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,532.021 1152.76,532.021 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,504.477 1152.76,504.477 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,449.389 1152.76,449.389 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,421.844 1152.76,421.844 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,394.3 1152.76,394.3 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,366.756 1152.76,366.756 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,311.668 1152.76,311.668 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,284.124 1152.76,284.124 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,256.58 1152.76,256.58 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,229.035 1152.76,229.035 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,173.947 1152.76,173.947 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,146.403 1152.76,146.403 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,118.859 1152.76,118.859 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.05; fill:none\" points=\"174.274,91.3147 1152.76,91.3147 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,614.653 193.172,614.653 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,476.933 193.172,476.933 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,339.212 193.172,339.212 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,201.491 193.172,201.491 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,63.7706 193.172,63.7706 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,587.109 183.723,587.109 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,559.565 183.723,559.565 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,532.021 183.723,532.021 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,504.477 183.723,504.477 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,449.389 183.723,449.389 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,421.844 183.723,421.844 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,394.3 183.723,394.3 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,366.756 183.723,366.756 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,311.668 183.723,311.668 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,284.124 183.723,284.124 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,256.58 183.723,256.58 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,229.035 183.723,229.035 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,173.947 183.723,173.947 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,146.403 183.723,146.403 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,118.859 183.723,118.859 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0; fill:none\" points=\"174.274,91.3147 183.723,91.3147 \"/>\n<path clip-path=\"url(#clip430)\" d=\"M68.9365 600.452 Q65.3254 600.452 63.4967 604.017 Q61.6912 607.558 61.6912 614.688 Q61.6912 621.795 63.4967 625.359 Q65.3254 628.901 68.9365 628.901 Q72.5707 628.901 74.3763 625.359 Q76.205 621.795 76.205 614.688 Q76.205 607.558 74.3763 604.017 Q72.5707 600.452 68.9365 600.452 M68.9365 596.748 Q74.7467 596.748 77.8022 601.355 Q80.8809 605.938 80.8809 614.688 Q80.8809 623.415 77.8022 628.021 Q74.7467 632.605 68.9365 632.605 Q63.1264 632.605 60.0477 628.021 Q56.9921 623.415 56.9921 614.688 Q56.9921 605.938 60.0477 601.355 Q63.1264 596.748 68.9365 596.748 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M89.0984 626.054 L93.9827 626.054 L93.9827 631.933 L89.0984 631.933 L89.0984 626.054 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M114.168 600.452 Q110.557 600.452 108.728 604.017 Q106.922 607.558 106.922 614.688 Q106.922 621.795 108.728 625.359 Q110.557 628.901 114.168 628.901 Q117.802 628.901 119.608 625.359 Q121.436 621.795 121.436 614.688 Q121.436 607.558 119.608 604.017 Q117.802 600.452 114.168 600.452 M114.168 596.748 Q119.978 596.748 123.033 601.355 Q126.112 605.938 126.112 614.688 Q126.112 623.415 123.033 628.021 Q119.978 632.605 114.168 632.605 Q108.358 632.605 105.279 628.021 Q102.223 623.415 102.223 614.688 Q102.223 605.938 105.279 601.355 Q108.358 596.748 114.168 596.748 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M144.33 600.452 Q140.719 600.452 138.89 604.017 Q137.084 607.558 137.084 614.688 Q137.084 621.795 138.89 625.359 Q140.719 628.901 144.33 628.901 Q147.964 628.901 149.769 625.359 Q151.598 621.795 151.598 614.688 Q151.598 607.558 149.769 604.017 Q147.964 600.452 144.33 600.452 M144.33 596.748 Q150.14 596.748 153.195 601.355 Q156.274 605.938 156.274 614.688 Q156.274 623.415 153.195 628.021 Q150.14 632.605 144.33 632.605 Q138.519 632.605 135.441 628.021 Q132.385 623.415 132.385 614.688 Q132.385 605.938 135.441 601.355 Q138.519 596.748 144.33 596.748 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M69.9319 462.731 Q66.3208 462.731 64.4921 466.296 Q62.6865 469.838 62.6865 476.967 Q62.6865 484.074 64.4921 487.639 Q66.3208 491.18 69.9319 491.18 Q73.5661 491.18 75.3717 487.639 Q77.2004 484.074 77.2004 476.967 Q77.2004 469.838 75.3717 466.296 Q73.5661 462.731 69.9319 462.731 M69.9319 459.028 Q75.742 459.028 78.7976 463.634 Q81.8763 468.217 81.8763 476.967 Q81.8763 485.694 78.7976 490.301 Q75.742 494.884 69.9319 494.884 Q64.1217 494.884 61.043 490.301 Q57.9875 485.694 57.9875 476.967 Q57.9875 468.217 61.043 463.634 Q64.1217 459.028 69.9319 459.028 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M90.0938 488.333 L94.978 488.333 L94.978 494.213 L90.0938 494.213 L90.0938 488.333 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M109.191 490.277 L125.51 490.277 L125.51 494.213 L103.566 494.213 L103.566 490.277 Q106.228 487.523 110.811 482.893 Q115.418 478.241 116.598 476.898 Q118.844 474.375 119.723 472.639 Q120.626 470.879 120.626 469.19 Q120.626 466.435 118.682 464.699 Q116.76 462.963 113.658 462.963 Q111.459 462.963 109.006 463.727 Q106.575 464.491 103.797 466.042 L103.797 461.319 Q106.621 460.185 109.075 459.606 Q111.529 459.028 113.566 459.028 Q118.936 459.028 122.131 461.713 Q125.325 464.398 125.325 468.889 Q125.325 471.018 124.515 472.94 Q123.728 474.838 121.621 477.43 Q121.043 478.102 117.941 481.319 Q114.839 484.514 109.191 490.277 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M135.371 459.653 L153.728 459.653 L153.728 463.588 L139.654 463.588 L139.654 472.06 Q140.672 471.713 141.691 471.551 Q142.709 471.366 143.728 471.366 Q149.515 471.366 152.894 474.537 Q156.274 477.708 156.274 483.125 Q156.274 488.703 152.802 491.805 Q149.33 494.884 143.01 494.884 Q140.834 494.884 138.566 494.514 Q136.32 494.143 133.913 493.402 L133.913 488.703 Q135.996 489.838 138.219 490.393 Q140.441 490.949 142.918 490.949 Q146.922 490.949 149.26 488.842 Q151.598 486.736 151.598 483.125 Q151.598 479.514 149.26 477.407 Q146.922 475.301 142.918 475.301 Q141.043 475.301 139.168 475.717 Q137.316 476.134 135.371 477.014 L135.371 459.653 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M68.9365 325.011 Q65.3254 325.011 63.4967 328.575 Q61.6912 332.117 61.6912 339.247 Q61.6912 346.353 63.4967 349.918 Q65.3254 353.46 68.9365 353.46 Q72.5707 353.46 74.3763 349.918 Q76.205 346.353 76.205 339.247 Q76.205 332.117 74.3763 328.575 Q72.5707 325.011 68.9365 325.011 M68.9365 321.307 Q74.7467 321.307 77.8022 325.913 Q80.8809 330.497 80.8809 339.247 Q80.8809 347.973 77.8022 352.58 Q74.7467 357.163 68.9365 357.163 Q63.1264 357.163 60.0477 352.58 Q56.9921 347.973 56.9921 339.247 Q56.9921 330.497 60.0477 325.913 Q63.1264 321.307 68.9365 321.307 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M89.0984 350.612 L93.9827 350.612 L93.9827 356.492 L89.0984 356.492 L89.0984 350.612 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M104.214 321.932 L122.57 321.932 L122.57 325.867 L108.496 325.867 L108.496 334.339 Q109.515 333.992 110.534 333.83 Q111.552 333.645 112.571 333.645 Q118.358 333.645 121.737 336.816 Q125.117 339.987 125.117 345.404 Q125.117 350.983 121.645 354.085 Q118.172 357.163 111.853 357.163 Q109.677 357.163 107.409 356.793 Q105.163 356.423 102.756 355.682 L102.756 350.983 Q104.839 352.117 107.061 352.673 Q109.284 353.228 111.76 353.228 Q115.765 353.228 118.103 351.122 Q120.441 349.015 120.441 345.404 Q120.441 341.793 118.103 339.687 Q115.765 337.58 111.76 337.58 Q109.885 337.58 108.01 337.997 Q106.159 338.413 104.214 339.293 L104.214 321.932 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M144.33 325.011 Q140.719 325.011 138.89 328.575 Q137.084 332.117 137.084 339.247 Q137.084 346.353 138.89 349.918 Q140.719 353.46 144.33 353.46 Q147.964 353.46 149.769 349.918 Q151.598 346.353 151.598 339.247 Q151.598 332.117 149.769 328.575 Q147.964 325.011 144.33 325.011 M144.33 321.307 Q150.14 321.307 153.195 325.913 Q156.274 330.497 156.274 339.247 Q156.274 347.973 153.195 352.58 Q150.14 357.163 144.33 357.163 Q138.519 357.163 135.441 352.58 Q132.385 347.973 132.385 339.247 Q132.385 330.497 135.441 325.913 Q138.519 321.307 144.33 321.307 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M69.9319 187.29 Q66.3208 187.29 64.4921 190.855 Q62.6865 194.396 62.6865 201.526 Q62.6865 208.632 64.4921 212.197 Q66.3208 215.739 69.9319 215.739 Q73.5661 215.739 75.3717 212.197 Q77.2004 208.632 77.2004 201.526 Q77.2004 194.396 75.3717 190.855 Q73.5661 187.29 69.9319 187.29 M69.9319 183.586 Q75.742 183.586 78.7976 188.193 Q81.8763 192.776 81.8763 201.526 Q81.8763 210.253 78.7976 214.859 Q75.742 219.443 69.9319 219.443 Q64.1217 219.443 61.043 214.859 Q57.9875 210.253 57.9875 201.526 Q57.9875 192.776 61.043 188.193 Q64.1217 183.586 69.9319 183.586 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M90.0938 212.892 L94.978 212.892 L94.978 218.771 L90.0938 218.771 L90.0938 212.892 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M103.983 184.211 L126.205 184.211 L126.205 186.202 L113.658 218.771 L108.774 218.771 L120.58 188.146 L103.983 188.146 L103.983 184.211 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M135.371 184.211 L153.728 184.211 L153.728 188.146 L139.654 188.146 L139.654 196.619 Q140.672 196.271 141.691 196.109 Q142.709 195.924 143.728 195.924 Q149.515 195.924 152.894 199.095 Q156.274 202.267 156.274 207.683 Q156.274 213.262 152.802 216.364 Q149.33 219.443 143.01 219.443 Q140.834 219.443 138.566 219.072 Q136.32 218.702 133.913 217.961 L133.913 213.262 Q135.996 214.396 138.219 214.952 Q140.441 215.507 142.918 215.507 Q146.922 215.507 149.26 213.401 Q151.598 211.294 151.598 207.683 Q151.598 204.072 149.26 201.966 Q146.922 199.859 142.918 199.859 Q141.043 199.859 139.168 200.276 Q137.316 200.693 135.371 201.572 L135.371 184.211 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M59.7467 77.1154 L67.3856 77.1154 L67.3856 50.7498 L59.0754 52.4165 L59.0754 48.1572 L67.3393 46.4906 L72.0152 46.4906 L72.0152 77.1154 L79.654 77.1154 L79.654 81.0506 L59.7467 81.0506 L59.7467 77.1154 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M89.0984 75.171 L93.9827 75.171 L93.9827 81.0506 L89.0984 81.0506 L89.0984 75.171 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M114.168 49.5693 Q110.557 49.5693 108.728 53.1341 Q106.922 56.6757 106.922 63.8053 Q106.922 70.9117 108.728 74.4765 Q110.557 78.0182 114.168 78.0182 Q117.802 78.0182 119.608 74.4765 Q121.436 70.9117 121.436 63.8053 Q121.436 56.6757 119.608 53.1341 Q117.802 49.5693 114.168 49.5693 M114.168 45.8656 Q119.978 45.8656 123.033 50.472 Q126.112 55.0553 126.112 63.8053 Q126.112 72.5321 123.033 77.1386 Q119.978 81.7219 114.168 81.7219 Q108.358 81.7219 105.279 77.1386 Q102.223 72.5321 102.223 63.8053 Q102.223 55.0553 105.279 50.472 Q108.358 45.8656 114.168 45.8656 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M144.33 49.5693 Q140.719 49.5693 138.89 53.1341 Q137.084 56.6757 137.084 63.8053 Q137.084 70.9117 138.89 74.4765 Q140.719 78.0182 144.33 78.0182 Q147.964 78.0182 149.769 74.4765 Q151.598 70.9117 151.598 63.8053 Q151.598 56.6757 149.769 53.1341 Q147.964 49.5693 144.33 49.5693 M144.33 45.8656 Q150.14 45.8656 153.195 50.472 Q156.274 55.0553 156.274 63.8053 Q156.274 72.5321 153.195 77.1386 Q150.14 81.7219 144.33 81.7219 Q138.519 81.7219 135.441 77.1386 Q132.385 72.5321 132.385 63.8053 Q132.385 55.0553 135.441 50.472 Q138.519 45.8656 144.33 45.8656 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><polyline clip-path=\"url(#clip432)\" style=\"stroke:#4477aa; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"201.967,614.653 207.977,614.653 263.547,614.58 296.942,614.093 325.177,612.814 340.513,611.545 355.848,609.718 369.986,607.431 384.124,604.461 399.282,600.404 414.44,595.331 423.22,591.884 432.001,588.042 440.782,583.788 449.563,579.106 457.366,574.577 465.169,569.692 472.973,564.447 480.776,558.836 494.461,548.107 508.147,536.246 523.068,522.041 537.989,506.551 552.999,489.735 568.008,471.771 584.603,450.704 601.198,428.544 616.988,406.625 632.778,384.087 665.613,336.13 693.254,295.777 710.127,271.679 727,248.288 742.456,227.681 757.913,208.023 772.189,190.835 786.464,174.675 800.925,159.433 815.385,145.39 823.488,138.061 831.591,131.126 839.694,124.589 847.798,118.449 862.483,108.329 877.169,99.4845 885.575,94.9792 893.982,90.8665 902.389,87.1337 910.796,83.7663 926.364,78.4393 941.933,74.1953 957.281,70.9489 972.629,68.5059 987.531,66.7797 1002.43,65.5716 1032.99,64.2557 1066.46,63.8282 1115.09,63.7706 1125.06,63.7706 \"/>\n<polyline clip-path=\"url(#clip432)\" style=\"stroke:#ee6677; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"201.967,614.653 207.977,611.067 263.547,577.904 296.942,557.975 325.177,541.124 355.848,522.82 384.124,505.946 414.44,487.854 449.563,466.894 480.776,448.267 508.147,431.932 537.989,414.123 568.008,396.208 601.198,376.401 632.778,357.555 665.613,337.96 693.254,321.464 727,301.326 757.913,282.877 786.464,265.839 815.385,248.579 847.798,229.236 877.169,211.708 910.796,191.64 941.933,173.059 972.629,154.74 1002.43,136.953 1032.99,118.72 1066.46,98.7433 1115.09,69.724 1125.06,63.7706 \"/>\n<path clip-path=\"url(#clip430)\" d=\"M206.89 222.229 L394.074 222.229 L394.074 66.7086 L206.89 66.7086  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"0.9\"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#222255; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.1; fill:none\" points=\"206.89,222.229 394.074,222.229 394.074,66.7086 206.89,66.7086 206.89,222.229 \"/>\n<polyline clip-path=\"url(#clip430)\" style=\"stroke:#4477aa; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"217.762,118.549 282.994,118.549 \"/>\n<path clip-path=\"url(#clip430)\" d=\"M318.928 116.889 Q318.928 120.309 317.195 123.612 Q315.485 126.914 312.792 128.952 Q310.098 130.966 307.358 130.966 Q305.718 130.966 304.617 130.076 Q303.54 129.163 302.954 127.874 Q302.509 129.467 301.549 133.285 Q300.588 137.103 300.588 137.478 Q300.588 137.688 300.635 137.782 Q300.682 137.876 300.893 137.993 Q301.104 138.134 301.619 138.18 Q302.134 138.251 303.001 138.251 Q303.446 138.251 303.61 138.251 Q303.797 138.274 303.961 138.391 Q304.149 138.508 304.149 138.766 Q304.149 139.726 303.282 139.726 Q302.509 139.726 300.916 139.656 Q299.324 139.586 298.527 139.586 Q297.848 139.586 296.49 139.656 Q295.131 139.726 294.499 139.726 Q293.866 139.726 293.866 139.164 Q293.866 138.836 293.96 138.625 Q294.03 138.438 294.218 138.344 Q294.405 138.274 294.569 138.251 Q294.709 138.251 294.991 138.251 Q296.068 138.251 296.536 138.063 Q297.005 137.899 297.169 137.548 Q297.356 137.22 297.567 136.283 L302.954 114.922 Q303.282 113.493 303.282 112.486 Q303.282 111.221 302.884 110.753 Q302.486 110.284 301.783 110.284 Q300.565 110.284 299.769 111.736 Q298.972 113.189 298.293 115.999 Q298.082 116.772 297.942 116.936 Q297.825 117.1 297.473 117.1 Q296.888 117.077 296.888 116.608 Q296.888 116.491 297.075 115.742 Q297.262 114.969 297.614 113.844 Q297.989 112.697 298.387 111.971 Q298.621 111.479 298.832 111.151 Q299.043 110.823 299.464 110.308 Q299.909 109.792 300.542 109.511 Q301.174 109.23 301.947 109.23 Q303.446 109.23 304.687 110.12 Q305.929 111.01 306.257 112.814 Q307.592 111.245 309.231 110.237 Q310.871 109.23 312.534 109.23 Q315.298 109.23 317.101 111.385 Q318.928 113.517 318.928 116.889 M315.462 114.781 Q315.462 112.65 314.642 111.479 Q313.846 110.284 312.393 110.284 Q310.59 110.284 308.505 112.111 Q306.444 113.844 306.022 115.461 L303.657 124.853 L303.516 125.626 Q303.516 125.766 303.587 126.188 Q303.68 126.586 303.938 127.242 Q304.219 127.898 304.594 128.483 Q304.992 129.046 305.695 129.467 Q306.421 129.889 307.311 129.889 Q308.739 129.889 310.285 128.624 Q311.855 127.359 313.026 124.97 Q313.752 123.424 314.595 120.098 Q315.462 116.749 315.462 114.781 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M324.287 118.435 Q324.287 110.331 327.309 103.796 Q328.597 101.056 330.401 98.7604 Q332.204 96.465 333.399 95.4578 Q334.593 94.4507 334.921 94.4507 Q335.39 94.4507 335.413 94.9191 Q335.413 95.1533 334.781 95.7389 Q327.051 103.609 327.075 118.435 Q327.075 133.308 334.593 140.874 Q335.413 141.694 335.413 141.951 Q335.413 142.42 334.921 142.42 Q334.593 142.42 333.446 141.459 Q332.298 140.499 330.518 138.297 Q328.738 136.096 327.449 133.402 Q324.287 126.867 324.287 118.435 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M359.833 106.443 Q359.833 110.378 358.568 114.805 Q357.327 119.208 355.36 122.768 Q353.392 126.305 350.816 128.647 Q348.239 130.966 345.78 130.966 Q344.21 130.966 343.039 130.1 Q341.892 129.21 341.259 127.734 Q340.627 126.235 340.322 124.595 Q340.018 122.932 340.018 121.129 Q340.018 118.435 340.603 115.507 Q341.189 112.556 342.173 109.886 Q343.156 107.192 344.538 104.757 Q345.92 102.297 347.443 100.517 Q348.989 98.7135 350.722 97.6595 Q352.455 96.6055 354.071 96.6055 Q355.242 96.6055 356.179 97.1208 Q357.14 97.6127 357.749 98.4793 Q358.358 99.3225 358.779 100.33 Q359.224 101.337 359.435 102.508 Q359.646 103.656 359.74 104.616 Q359.833 105.553 359.833 106.443 M356.671 103.468 Q356.671 102.274 356.578 101.384 Q356.484 100.47 356.226 99.5567 Q355.969 98.6433 355.406 98.1514 Q354.868 97.6595 354.025 97.6595 Q351.565 97.6595 348.801 102.695 Q347.911 104.265 347.115 106.396 Q346.319 108.528 346.037 109.535 Q345.756 110.542 345.101 113.025 L355.125 113.025 Q356.671 106.63 356.671 103.468 M354.704 114.547 L344.726 114.547 Q343.18 120.403 343.18 124.057 Q343.18 127.242 343.836 128.577 Q344.515 129.889 345.78 129.889 Q347.232 129.889 348.59 128.437 Q349.949 126.961 351.331 124.291 Q353.158 120.824 354.704 114.547 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip430)\" d=\"M364.783 141.951 Q364.783 141.717 365.392 141.132 Q373.122 133.262 373.122 118.435 Q373.122 103.562 365.697 96.0434 Q364.783 95.1767 364.783 94.9191 Q364.783 94.4507 365.252 94.4507 Q365.58 94.4507 366.727 95.411 Q367.898 96.3713 369.655 98.573 Q371.435 100.775 372.747 103.468 Q375.909 110.003 375.909 118.435 Q375.909 126.539 372.887 133.074 Q371.599 135.815 369.796 138.11 Q367.992 140.405 366.797 141.413 Q365.603 142.42 365.252 142.42 Q364.783 142.42 364.783 141.951 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><polyline clip-path=\"url(#clip430)\" style=\"stroke:#ee6677; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"217.762,170.389 282.994,170.389 \"/>\n<path clip-path=\"url(#clip430)\" d=\"M313.682 162.888 Q313.682 166.823 312.417 171.25 Q311.175 175.654 309.208 179.214 Q307.24 182.751 304.664 185.093 Q302.088 187.412 299.628 187.412 Q298.059 187.412 296.888 186.545 Q295.74 185.655 295.108 184.179 Q294.475 182.68 294.171 181.041 Q293.866 179.378 293.866 177.574 Q293.866 174.881 294.452 171.953 Q295.037 169.002 296.021 166.332 Q297.005 163.638 298.387 161.202 Q299.769 158.743 301.291 156.963 Q302.837 155.159 304.57 154.105 Q306.304 153.051 307.92 153.051 Q309.091 153.051 310.028 153.566 Q310.988 154.058 311.597 154.925 Q312.206 155.768 312.628 156.775 Q313.073 157.782 313.283 158.953 Q313.494 160.101 313.588 161.061 Q313.682 161.998 313.682 162.888 M310.52 159.914 Q310.52 158.719 310.426 157.829 Q310.332 156.916 310.075 156.002 Q309.817 155.089 309.255 154.597 Q308.716 154.105 307.873 154.105 Q305.413 154.105 302.65 159.141 Q301.76 160.71 300.963 162.842 Q300.167 164.973 299.886 165.98 Q299.605 166.987 298.949 169.47 L308.974 169.47 Q310.52 163.076 310.52 159.914 M308.552 170.993 L298.574 170.993 Q297.028 176.848 297.028 180.502 Q297.028 183.688 297.684 185.023 Q298.363 186.334 299.628 186.334 Q301.08 186.334 302.439 184.882 Q303.797 183.406 305.179 180.736 Q307.006 177.27 308.552 170.993 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /></svg>\n```\n\nExample of $p$ such that there are multiple solutions to $p(θ) = θ$.\n:::\n:::\n\n\nSuppose that $p(θ)$ is such that there exists a $θ_\\circ$ such that $p(θ) > θ$ for $θ \\in (θ_\\circ, 1)$ and $p(θ) < θ$ for $θ \\in (0, θ_\\circ)$. See @fig-p-vs-theta, for example. Then, the set of equilibrium points are $H = \\{0, θ_\\circ, 1\\}$. Out of these $\\{0, 1\\}$ are stable and $θ_\\circ$ is unstable. The stochastic approximation theory shows that the iterations \\eqref{eq:SA} will converge to either $0$ or $1$. Thus, along each sample path, the iterates $\\{θ_t\\}_{t \\ge 1}$ will be 'locked into' one color which will dominate. \n\nMultiple runs starting with different initial conditions are shown in @fig-urn-multiple-runs. Note that the discrete-time iterates are stochastic and oscillate, as expected. However, the eventually converge to the stable equilibrium points of the ODE \\eqref{eq:ODE}\n\n\n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\nRandom.seed!(42)\n\nT = 10       # Number of time steps\nM = 25       # Number of different runs\nα = zeros(T)\nfor t in 1:T\n    α[t] = 1/(t+1)\nend\n\nθ = zeros(T,M)\nfor m in 1:M\n    θ[1,m] = mod((m/M + rand()/M),1)\n    for t in 1:T-1\n        θ[t+1,m] = θ[t,m] + α[t]*(rand(Bernoulli(p(θ[t,m]))) - θ[t,m])\n    end\nend\n```\n:::\n\n\n::: {.cell execution_count=6}\n\n::: {.cell-output .cell-output-stderr}\n```\n┌ Warning: JSON package not available. Please install the JSON.jl package to use ojs_define.\n└ @ Main In[1]:93\n```\n:::\n:::\n\n\n```{ojs}\n//| label: fig-urn-multiple-runs\n//| fig-cap: Multiple runs of the urn model (@exm-urn-model) for different initial conditions.\nSimulationPlot = Plot.plot({\n  grid: true,\n  marks: [\n    // Axes\n    Plot.ruleX([1]),\n    Plot.ruleY([0]),\n    // Data\n    Plot.line(theta, {x: \"time\", y: \"value\", z: \"run\", stroke: \"#9ecae1\" })\n  ]}\n)\n```\n\n\nWe now summarize the sufficient conditions of convergence.\n\n## List of assumptions\n\nLet $\\mathcal F_t = σ(θ_{1:t}, ξ_{1:t})$. We state the following set of assumptions but note that not every assumption is needed for every result.\n\n### Assumptions on the function $f$\n\n**F1.** $θ^*$ is a solution of the equation $f(θ) = 0$.\n\n**F1'.** $θ^*$ is _the unique_ solution of the equation $f(θ) = 0$.\n\n**F2.** The function $f$ is [globally Lipschitz-continuous][Lipschitz] with constant $L$, i.e., for any $θ_1, θ_2 \\in \\reals^d$,\n$$\n  \\| f(θ_1) - f(θ_2) \\|_{2} \\le L \\| θ_1 - θ_2 \\|_2.\n$$\n**F2'.** The function $f$ is twice differentiable and is globally Lipschitz continuous with constant $L$. \n\n:::{.callout-tip}\n### Implication\nAssumption (F2) implies that for each $θ \\in \\reals^d$, there is a unique function $s(\\cdot, θ)$ that satisfies the ODE\n$$\n  \\frac{ds(t,θ)}{dt} = f(s(t,θ)), \\quad\n  s(0,θ) = θ.\n$$\n:::\n\n**F3.** The equilibrium $θ^*$ of the ODE $\\dot θ = f(θ)$ is globally asymptotically  stable. \n\n**F3'.** The equilibrium $θ^*$ of the ODE $\\dot θ = f(θ)$ is globally _exponentially_ stable. Thus, there exists constants $μ \\ge 1$ and $γ > 0$ such that\n$$\n\\| s(t,θ) - θ^*\\|_2 \\le μ\\|θ - θ^*\\|_2 \\exp(-γ t), \n\\quad\n\\forall t \\ge 0, \\forall θ \\in \\reals^d.\n$$\n\n**F4.** There is a finite constant $K$ such that \n$$\n\\| \\nabla^2 f_i(θ) \\|_{S} \\cdot \\| θ - θ^*\\|_2 \\le K, \n\\quad\n\\forall i \\in \\{1, \\dots, d\\}, \n\\forall θ \\in \\reals^d,\n$$\nwhere $\\|\\cdot\\|_S$ denotes the spectral norm of a matrix (i.e., the largest singular value). \n\n:::{.callout-tip}\n### Implication\nAssumption (F4) implies that \n$$\n\\left| \\frac{∂^2 f_i(θ)}{∂θ_j ∂θ_k}\\right| \\cdot \\| θ - θ^*\\|_2 \\le K,\n\\quad\n\\forall i.j,k, \\in \\{1,\\dots, d\\},\n\\forall θ \\in \\reals^d.\n$$\n:::\n\n### Conditions on the noise\n\n**N1.** $\\{ξ_t\\}_{t \\ge 0}$ is a [martingale difference sequence][MDS] with respect to $\\{ \\mathcal F_t\\}_{t \\ge 1}$, i.e.,\n$$ \\EXP[ ξ_{t+1} | \\mathcal F_t ] = 0, \\text{ a.s.}, \\quad t \\ge 1. $$\n\n**N2.** The noise $\\{ξ_t\\}_{t \\ge 1}$ satisfies\n$$\n\\EXP[ \\| ξ_{t+1}^2 \\|_2^2 \\mid \\mathcal F_t ] \\le \nσ^2( 1 + \\| θ_t - θ^*\\|_{2}^2), \n\\quad \\text{a.s. } \\forall t \\ge 1\n$$\nfor some finite constant $σ^2$. \n\n[MDS]: ../probability/martingales.qmd#examples\n\n### Conditions on the learning rate\n\n**R1.** $\\sum_{t \\ge 1} α_t^2 < ∞$.\n\n**R2.** $\\sum_{t \\ge 1} α_t = ∞$.\n\n**R3.** There exists constants $\\underline α, \\bar α \\in (0,1)$ such that\n    $\\underline α \\le α_t \\le \\bar α$ for all $t \\ge 1$. \n\n\n## Gladyshev's result\n\nThe following is a restatement of the result of @Gladyshev1965.\n\n:::{#thm-Gladyshev}\nSuppose assumptions (F1'), (N1), and (N2) hold. In addition, the function $f(\\cdot)$ is passive, i.e., for each $0 < ε < M < ∞$, \n$$ \\sup_{ε < \\| θ - θ^*\\|_2 < M} \n  \\langle θ - θ^*, f(θ) \\rangle \n < 0$$\n and\n $$\\|f(θ)\\|_2 \\le K \\|θ - θ^*\\|_2, \\quad K < ∞.$$\n Then,\n\n 1. If (R1) holds, then $\\{θ_t\\}$ is bounded almost surely.\n 2. In addition, if (R2) holds, then $θ_t \\to θ^*$ almost surely as $t \\to ∞$. \n:::\n\n:::{.callout-tip}\n### Remark\nThe second assumption $\\|f(θ)\\|_2 \\le K \\| θ - θ^*\\|_2$ implies that $f(⋅)$ is continuous as $θ^*$, but it need not be continuous anywhere else.\n:::\n\n\n<!-- :::{.callout-note collapse=\"false\"}\n#### Proof\nFrom \\\\eqref{eq:SA}, we get\n\\begin{align}\n  \\EXP[ \\|θ_{t+1} - θ^*\\|_2^2 \\mid \\mathcal F_t] \n   &\\stackrel{(a)}= \n  \\|θ_t - θ^*\\|_2^2 -2 α_t \\langle θ_t - θ^*,  f(θ_t) \\rangle \n  + α_t^2 \\bigl[ \\| f(θ_t) \\|_2^2 + ξ^2 \\bigr]\n  \\notag \\\\\n  &\\stackrel{(b)}\\le\n\\end{align}\nwhere $(a)$ uses (N1)\n::: -->\n\n## Borkar-Meyn's result {#sec-borkar-meyn}\n\nThe following is a restatement of the result of @Borkar2000.\n\n:::{#thm-borkar-meyn}\nSuppose assumptions (F2), (N1), and (N2) hold. In addition:\n\na. There exists a limit function $f_{∞} \\colon \\reals^d \\to \\reals^d$ such that\n$$\n  \\lim_{r \\to ∞} \\frac{f(r θ)}{r} = f_{∞}(θ), \\quad\n  \\forall θ \\in \\reals^d.\n$$\n\nb. Origin is asymptotically stable equilibrium of the ODE\n$$\n  \\dot θ(t) = f_{∞}(θ(t)).\n$$\n\nThen, \n\n1. If (R1) and (R2) hold, then $\\{θ_t\\}_{t \\ge 1}$ is bounded almost surely. \n2. In addition, if (F3) holds, then $θ_t \\to θ^*$ almost surely as $t \\to ∞$. \n3. If (F3) and (R3) hold, then:\n    \n   - there exists a $α^* > 0$ and $C_1 < ∞$ such that if $\\bar α \\le α^*$ then \n     $$ \n        \\limsup_{n \\to ∞} \\EXP[ \\| θ_k\\|^2 ] \\le C_1.\n     $$\n\n   - if $\\bar α \\le α^*$ then $θ_t \\to θ^*$ in probability. In particular, for any $ε > 0$, there exists a $b_1 = b_1(ε) < ∞$ such that \n     $$\n        \\limsup_{n \\to ∞} \\PR( \\| θ_k - θ^* \\| \\ge ε ) \\le b_1 \\bar α.\n     $$\n\n   - In addition, if (F3') holds, then $θ_t \\to θ^*$ in mean square. In particular, there exists a $b_2 < ∞$ such that for any initial condition $θ_0 \\in \\reals^d$, \n     $$\n        \\limsup_{n \\to ∞} \\EXP[ \\| θ_k - θ^*\\|^2 ] \\le b_2 \\bar α. \n     $$\n:::\n\n:::{.callout-tip}\n### Rates of convergence\n\n@Borkar2000 also provides rates of convergence of stochastic approximation under stronger assumptions. \n:::\n\n[Lipschitz]: ../mdps/lipschitz-mdps.qmd\n\n## Vidyasagar's result\n\nThe following is a restatement of the result of @Vidyasagar2023.\n\n:::{.callout-tip}\n#### Function classes\nConsider a continuous function $f \\colon \\reals_{\\ge 0} \\to \\reals_{\\ge 0}$. \n\n* The function $f$ is said to belong to class $\\mathcal K$ if $f(0) = 0$ and $f(\\cdot)$ is strictly increasing.\n* The function $f \\in \\ALPHABET K$ is said to belong to class $\\ALPHABET K \\ALPHABET R$ if, in addition, $f(r) \\to ∞$ as $s \\to ∞$. \n* The function $f$ is said to belong to class $\\ALPHABET B$ if $f(0) = 0$ and, in iaddition for all $0 < ε < M < ∞$, we have\n  $$\n  \\inf_{ε \\le r \\le M} f(r) > 0.\n  $$\n:::\n\n:::{#exm-class-K-vs-B}\nObserve that every function $f$ of class $\\ALPHABET K$ also belongs to class $\\ALPHABET B$ but the converse is not true. For example, let\n$$\n  f(r) = \\begin{cases}\n  r, & \\text{if } r \\in [0,1], \\\\\n  e^{-(r-1)}, & \\text{if } r > 1.\n  \\end{cases}\n$$\nThen, $f$ belongs to class $\\ALPHABET B$. \n\nHowever, since $f(r) \\to 0$ as $r \\to ∞$, $f$ cannot be bounded below by any function of class $\\ALPHABET K$. \n:::\n\n:::{#thm-vidyasagar-1}\nSuppose assumptions (F1), (F2), (N1), and (N2) hold. In addition, suppose that there exists a twice differentiable Lyapunov function $V \\colon \\reals^d \\to \\reals_{\\ge 0}$ that satisfies the following conditions:\n\n* there exist constants $a, b > 0$ such that\n  \\begin{equation}\\label{eq:vidyasagar-cond-1}\n    a \\| θ - θ^*\\|_2^2 \\le V(θ) \\le b \\| θ - θ^* \\|_2^2, \n    \\quad \\forall θ \\in \\reals^d.\n  \\end{equation}\n\n* There is a finite constant $M$ such that\n  \\begin{equation}\\label{eq:vidyasagar-cond-2}\n  \\| \\GRAD^2 V(θ) \\|_S \\le 2M,\n    \\quad \\forall θ \\in \\reals^d.\n  \\end{equation}\nThen,\n\n1. If $\\dot V(θ) \\coloneqq \\langle \\GRAD V(θ), f(θ) \\rangle \\le 0$ for all $θ \\in \\reals^d$ and (R1) holds, then the iterates $\\{θ_t\\}_{t \\ge 1}$ are bounded almost surely.\n\n2. If, in addition, (R2) holds and there exists a function $\\phi \\in \\ALPHABET B$ such that\n   $$\n    \\dot V(θ) \\le - \\phi(\\| θ - θ^*\\|_2),\n    \\quad \\forall θ \\in \\reals^d.\n   $$\n   Then, $θ_t \\to θ^*$ almost surely as $t \\to ∞$. \n:::\n\n:::{.callout-tip}\n#### Discussion of the conditions\n\nIt is worthwhile to compare the conditions of @thm-borkar-meyn and @thm-vidyasagar-1. \n\n1. In @thm-borkar-meyn, it is assumed that (F1') holds while in @thm-vidyasagar-1, it is assumed that (F1) holds. That is, there is no assumption that $θ^*$ is the unique solution of $f(θ) = 0$. \n\n2. The assumptions on $\\dot V$ in part 1 of @thm-vidyasagar-1 imply only that $θ^*$ is a _locally stable_ equilibrim of the ODE \\\\eqref{eq:ODE}. This is in contrast to @thm-borkar-meyn imply that $θ^*$ is _globally asymptotically stable_.\n\n3. The assumptions in part 2 of @thm-vidyasagar-2 ensure that $θ^*$ is globally asymptotically stable equilibrium of the ODE \\\\eqref{eq:ODE}. Therefore, assumption (F1') is implicit in the second part of @thm-vidyasagar-1.\n\n:::\n\n:::{.callout-note collapse=\"true\"} \n#### Proof\nWe first start by establishing a bound on $\\EXP[V(θ_{t+1}) \\mid \\ALPHABET  F_t]$. To do so, observe that by Taylor series, we have\n$$\n  V(θ + η) = V(θ) + \\langle \\GRAD V(θ), η \\rangle\n  + \\frac 12 \\langle η, \\GRAD^2 V(θ + λη)η \\rangle\n$$\nfor some $λ \\in [0,1]$. Since $\\NORM{\\GRAD^2 V(θ+λη)}_S \\le 2M$, it follows that\n$$\n  V(θ + η) \\le V(θ) + \\langle \\GRAD V(θ), η \\rangle\n  + M \\NORM{η}_2^2.\n$$\nNow apply the above bound with $θ = θ_t$ and $η = θ_{t+1} - θ_t = α_t f(θ_t) + α_t ξ_{t+1}$. This gives\n\\begin{align*}\nV(θ_{t+1}) &\\le V(θ_t) \n+ α_t \\langle \\GRAD V(θ_t), f(θ_t) \\rangle\n+ α_t \\langle \\GRAD V(θ_t), ξ_{t+1} \\rangle\n  \\notag \\\\\n&\\quad  + α_t^2 M \\bigl[ \\NORM{f(θ_t)}_2^2 + \\NORM{ξ_{t+1}}_2^2 + \n2 \\langle f(θ_t), ξ_{t+1} \\rangle\n\\bigr] \n\\end{align*}\nRecall that $\\langle V(θ), f(θ) \\rangle \\eqqcolon \\dot V(θ)$. \nNow, we can bound $\\EXP[V(θ_{t+1}) \\mid \\ALPHABET F_t]$ using assumptions (N1) and (N2). \n\\begin{equation*}\n\\EXP[V(θ_{t+1}) \\mid \\ALPHABET F_t] \\le V(θ_t) \n+ α_t \\dot V(θ_t)\n + α_t^2 M \\bigl[ \\NORM{f(θ_t)}_2^2 + σ^2(1 + \\NORM{θ_t - θ^*}_2^2)\n\\bigr] \n\\end{equation*}\nAssumption (F1) and (F2) implies that \n$$\n\\NORM{f(θ_t)}_2^2 = \\NORM{f(θ_t) - f(θ^*)}_2^2 \\le L^2 \\NORM{θ_t - θ^*}_2^2.\n$$\nSubstituting in the above bound, we get:\n\\begin{equation}\\label{eq:vidyasagar-1-pf-step-1}\n\\EXP[V(θ_{t+1}) \\mid \\ALPHABET F_t] \\le V(θ_t) \n+ α_t \\dot V(θ_t)\n+ α_t^2 M \\bigl[ σ^2 + (σ^2 + L^2)\\NORM{θ_t - θ^*}_2^2 \\bigr].\n\\end{equation}\n\n### Proof of part 1. {-}\n\nUnder the stated assumptions, we can simplify \\\\eqref{eq:vidyasagar-1-pf-step-1}\n\\begin{align*}\n\\EXP[V(θ_{t+1}) \\mid \\ALPHABET F_t] \n&\\stackrel{(a)}\\le \nV(θ_t) \n+ α_t^2 M \\bigl[ σ^2 + (σ^2 + L^2)\\NORM{θ_t - θ^*}_2^2 \\bigr]\n  \\notag \\\\\n&\\stackrel{(b)}\\le \n\\biggl[ 1 + \\frac{α_t^2 M}{a} (L^2 + σ^2) \\biggr] V(θ_t) \n+ \n  α_t^2 M σ^2\n\\end{align*}\nwhere $(a)$ follows from the assumption that $\\dot V(θ) < 0$ and \n$(b)$ follows from $V(θ) \\ge a \\NORM{θ - θ^*}_2^2$. \n\nThus, $\\{V(θ_t)\\}_{t \\ge 1}$ is an \"almost\" supermartingale. Apply @thm-almost-supermartingale with $X_t = V(θ_t)$, $β_t = α_t^2 M(L^2 + σ^2)/a$, $Y_t = α_t^2 M σ^2$, and $Z_t = 0$. Then, from (R2) it follows that $\\lim_{t \\to ∞} V(θ_t)$ exists almost surely and is finite. Condition \\\\eqref{eq:vidyasagar-cond-1} implies that $\\{θ_t\\}_{t \\ge 1}$ is almost surely bounded. \n\n### Proof of part 2. {-}\n\nUnder the stated assumptions, we can simplify \\\\eqref{eq:vidyasagar-1-pf-step-1}\n\\begin{align*}\n\\EXP[V(θ_{t+1}) \\mid \\ALPHABET F_t] \n&\\stackrel{(c)}\\le \n\\biggl[ 1 + \\frac{α_t^2 M}{a} (L^2 + σ^2) \\biggr] V(θ_t) \n+ \n  α_t^2 M σ^2\n- α_t \\phi(\\NORM{θ_t - θ^*}_2)\n\\end{align*}\nwhere the first two terms are simplified in the same way as above and the last term corresponds to the upper bound on $\\dot V(θ_t) \\le -\\phi(\\NORM{θ_t - θ^*}_2^2)$. \n\nWe can again apply @thm-almost-supermartingale with $X_t = V(θ_t)$, $β_t = α_t^2 M(L^2 + σ^2)/a$, $Y_t = α_t^2 M σ^2$, and $Z_t = α_t \\phi(\\NORM{θ_t - θ^*}_2)$. \nThus, we can conclude that \nthere exists a random variable $ζ$ such that $V(θ_t) \\to ζ$ and\n\\begin{equation}\\label{eq:vidyasagar-1-pf-step-2}\n\\sum_{t \\ge 1} α_t \\phi(\\NORM{θ_t - θ^*}_2^2) < ∞,\n\\quad \\mathrm{a.s.}\n\\end{equation}\n\nLet $Ω_1 \\subset Ω$ denote the values of $ω$ for which\n$$\n  \\sup_{t \\ge 1} V(θ_t(ω)) < ∞,\n  \\lim_{t \\to ∞} V(θ_t(ω)) = ζ(ω),\n  \\sum_{t \\ge 1} α_t \\phi(\\NORM{θ_t(ω) - θ^*}_2) < ∞.\n$$\nFrom @thm-almost-supermartingale, we know that $P(Ω_1) = 1$. We will now show that $ζ(ω) = 0$ for all $ω \\in Ω_1$ by contradiction. Assume that for some $ω \\in Ω_1$, we have $ζ(ω) = 2 ε > 0$. Choose a $T$ such that $V(θ_t(ω)) \\ge ε$ for all $t \\ge T$. Define $V_M = \\sup_{t \\ge 1} V(θ_t(ω))$. Then, we have that\n$$\n  \\sqrt{\\frac{ε}{b}} \\le \\NORM{θ_t}_2 \\le \\sqrt{\\frac{V_M}{a}},\n  \\quad \\forall t \\ge T.\n$$\n\nDefine $δ = \\inf_{\\sqrt{ε/b} \\le r \\le \\sqrt{V_M/a}} \\phi(r)$ and observe that $δ > 0$ because $\\phi$ belongs to class $B$. Therefore,\n$$\n\\sum_{t \\ge T} α_t \\phi(\\NORM{θ_t - θ^*}_2) \\ge\n\\sum_{t \\ge T} α_t δ = ∞,\n$$\ndue to (R2). But this contradicts \\\\eqref{eq:vidyasagar-1-pf-step-2}. Hence, there is no $ω \\in Ω_1$ such that $ζ(ω) > 0$. Therefore, $ζ = 0$ almost surely, i.e., $V(θ_t) \\to 0$ almost surely. Finally, it follows from \\\\eqref{eq:vidyasagar-cond-1} that $θ_t \\to θ^*$ almost surely as $t \\to ∞$. \n:::\n\n\n@thm-vidyasagar-1 requires the existence of a suitable Lyapunov function that satisfies various conditions. Verifying whether or not such a function exists can be a bottleneck. \n\nIf can be shown (see Theorem 4 of @Vidyasagar2023) that the conditions on $V$ in @thm-vidyasagar-1 ensure that the equilibrium $θ^*$ of the ODE \\\\eqref{eq:ODE} is globally asymptotically stable. By strengthening this assumption to global _exponential_ stability of $θ^*$ and adding a few other conditions, it is possible to establish a \"converse\" Lyapunov theorem that establishes the existence of such a $V$. This is done below.\n\n:::{#thm-vidyasagar-2} \nSuppose assumptions (F1'), (F2'), (F3) and (F4) hold. Then, there exists a twice differentiable function $V \\colon \\reals^d \\to \\reals_{\\ge 0}$ such that $V$ and its derivative $\\dot V \\colon \\reals^d \\to \\reals_{\\ge 0}$ defined as $\\dot V(θ) \\coloneqq \\langle \\langle \\GRAD V(θ), f(θ) \\rangle$ together satisfy the following conditions: there exist positive constants $a$, $b$, $c$, and a finite constant $M$ such that for all $θ \\in \\reals^d$:\n\n* $a\\NORM{θ - θ^*}_2^2 \\le V(θ) \\le b\\NORM{θ - θ^*}_2^2$,\n* $\\dot V(θ) \\le -c\\NORM{θ - θ^*}_2^2$,\n* $\\NORM{\\GRAD^2 V(θ)}_S \\le 2M$.\n:::\n\nCombining @thm-vidyasagar-1 and @thm-vidyasagar-2, we get the following \"self-contained\" theorem:\n\n:::{#thm-vidyasagar-3}\nSuppose assumptions (F1'), (F2'), (F3), and (F4) as well as assumptions (N1) and (N2) hold. Then,\n\n1. If (R1) holds then $\\{θ_t\\}_{t \\ge 1}$ is bounded almost surely.\n2. If, in addition, (R2) holds then $\\{θ_t\\}_{t \\ge 1}$ converges almost surely to $θ^*$ as $t \\to ∞$. \n:::\n\n## Notes {-}\n\nThe stochastic approximation algorithm was introduced by @Robbins1951. See @Lai2003 for a historical overview.\n\n@exm-urn-model is borrowed from @Borkar2008, who points out that it was proposed by @Arthur1994 to model the phenomenon of decreasing returns in economics.\n\nThe material in this section is adapted from @Vidyasagar2023.\n\n",
    "supporting": [
      "stochastic-approximation_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}